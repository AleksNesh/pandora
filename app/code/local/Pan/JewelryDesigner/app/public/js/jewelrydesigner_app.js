var alchemy=alchemy||{};!function(A){A.partial=function(){var fn=arguments[0],args=Array.prototype.slice.call(arguments,1);return function(){alchemy.log("test");for(var arg=0,i=0;i<args.length&&arg<arguments.length;i++)"undefined"==typeof args[i]&&(args[i]=arguments[arg++]);return fn.apply(this,args)}},A.debounce=function(fn,delay,scope){delay="undefined"!=typeof delay?delay:250;var timer=null;return function(){var context=scope||this,args=arguments;clearTimeout(timer),timer=setTimeout(function(){fn.apply(context,args)},delay)}},A.throttle=function(fn,threshhold,scope){threshhold="undefined"!=typeof threshhold?threshhold:250;var last,deferTimer;return function(){var context=scope||this,now=A.now(),args=arguments;last&&last+threshhold>now?(clearTimeout(deferTimer),deferTimer=setTimeout(function(){last=now,fn.apply(context,args)},threshhold)):(last=now,fn.apply(context,args))}},A.noop=function(){},A.isArray=function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},A.isFunction=function(obj){return"[object Function]"===Object.prototype.toString.call(obj)},A.isString=function(obj){return"[object String]"===Object.prototype.toString.call(obj)},A.randomColor=function(){var hue="#"+String(Math.floor(256*Math.random()))+String(Math.floor(256*Math.random()))+String(Math.floor(256*Math.random()));return hue},A.log=function(){try{console.log.apply(console,arguments)}catch(err){try{opera.postError.apply(opera,arguments)}catch(err){alert(Array.prototype.join.call(arguments," "))}}},A.err=function(){try{console.error.apply(console,arguments)}catch(err){try{opera.postError.apply(opera,arguments)}catch(err){alert(Array.prototype.join.call(arguments," "))}}},A.assert=function(value,desc,halt){if(value)A.log("PASS: ",desc);else if(A.err("FAIL: ",desc),halt)throw new Error("Halting due to failed assertion.")},A.time=function(){for(var f=arguments[0],iter=arguments[1],start=A.now(),i=0;iter>i;i++)f.apply(window,Array.prototype.slice.call(arguments,2));var end=A.now();return end-start},A.now=function(){return(new Date).getTime()},A.getCords=function(evt){if("undefined"==typeof TouchEvent||!(evt.originalEvent instanceof TouchEvent))return{x:evt.pageX,y:evt.pageY};if("undefined"!=typeof TouchEvent&&evt.originalEvent instanceof TouchEvent){if(evt.originalEvent.touches.length>0)return{x:evt.originalEvent.touches[0].pageX,y:evt.originalEvent.touches[0].pageY};if(evt.originalEvent.changedTouches.length>0)return{x:evt.originalEvent.changedTouches[0].pageX,y:evt.originalEvent.changedTouches[0].pageY}}},A.getQueryVariable=function(variable){for(var query=window.location.search.substring(1),vars=query.split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable)return pair[1]}return!1},A.mobileCheck=function(){var check=!1;return function(a){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(check=!0)}(navigator.userAgent||navigator.vendor||window.opera),check}}(alchemy);var alchemy=alchemy||{};!function(A){A.loadImages=function(sources,options){sources=A.isArray(sources)?sources:[sources],options=A.isFunction(options)?{success:options}:options,A.loadImages._cache=A.loadImages._cache||{};for(var images=[],imagesLoaded=0,onload=function(){imagesLoaded+=1,1==sources.length?options.success(image):imagesLoaded==sources.length&&options.success&&options.success(images)},onerror=function(){options.error&&options.error()},i=0;i<sources.length;i++)if(options.cache&&sources[i]in A.loadImages._cache)images.push(A.loadImages._cache[sources[i]]),imagesLoaded+=1,1==sources.length?options.success(A.loadImages._cache[sources[i]]):imagesLoaded==sources.length&&options.success&&options.success(images);else{var image=new Image;images.push(image),options.cache&&(A.loadImages._cache[sources[i]]=image),options.crossOrigin&&(image.crossOrigin="anonymous"),image.onload=onload,image.onerror=onerror,image.src=sources[i]}},A.clearImageCache=function(){for(var key in A.loadImages._cache)A.loadImage._cache.hasOwnProperty(key)&&delete A.loadImages._cache[key]},A.editImage=function(source,options,callback){var opt=options||{},sourceImage=new Image;sourceImage.onload=function(){opt.width="undefined"!=typeof opt.width?opt.width:sourceImage.width,opt.height="undefined"!=typeof opt.height?opt.height:sourceImage.height,opt.srcX="undefined"!=typeof opt.srcX?opt.srcX:0,opt.srcY="undefined"!=typeof opt.srcY?opt.srcY:0,opt.srcWidth="undefined"!=typeof opt.srcWidth?opt.srcWidth:sourceImage.width,opt.srcHeight="undefined"!=typeof opt.srcHeight?opt.srcHeight:sourceImage.height,opt.destX="undefined"!=typeof opt.destX?opt.destX:0,opt.destY="undefined"!=typeof opt.destY?opt.destY:0,opt.destWidth="undefined"!=typeof opt.destWidth?opt.destWidth:opt.width,opt.destHeight="undefined"!=typeof opt.destHeight?opt.destHeight:opt.height,opt.toDataURLArgs="undefined"!=typeof opt.toDataURLArgs?opt.toDataURLArgs:["image/png"];var canvas=document.createElement("canvas");canvas.width=opt.width,canvas.height=opt.height;var ctx=canvas.getContext("2d");ctx.drawImage(sourceImage,opt.srcX,opt.srcY,opt.srcWidth,opt.srcHeight,opt.destX,opt.destY,opt.destWidth,opt.destHeight),opt.background&&(ctx.globalCompositeOperation="destination-over",ctx.fillStyle=opt.background,ctx.fillRect(0,0,opt.width,opt.height)),callback(canvas.toDataURL.apply(canvas,opt.toDataURLArgs))},sourceImage.src=source},A.addImage=function(source,image,options,callback){var opt=options||{},sourceImage=new Image;sourceImage.onload=function(){opt.destX="undefined"!=typeof opt.destX?opt.destX:0,opt.destY="undefined"!=typeof opt.destY?opt.destY:0,opt.destWidth="undefined"!=typeof opt.destWidth?opt.destWidth:image.width,opt.destHeight="undefined"!=typeof opt.destHeight?opt.destHeight:image.height,opt.toDataURLArgs="undefined"!=typeof opt.toDataURLArgs?opt.toDataURLArgs:["image/png"];var canvas=document.createElement("canvas");canvas.width=sourceImage.width,canvas.height=sourceImage.height;var ctx=canvas.getContext("2d");ctx.drawImage(sourceImage,0,0),ctx.drawImage(image,opt.destX,opt.destY,opt.destWidth,opt.destHeight),callback(canvas.toDataURL.apply(canvas,opt.toDataURLArgs))},sourceImage.src=source},A.getWhitespaceBoundary=function(source,callback){var sourceImage=new Image;sourceImage.onload=function(){var canvas=document.createElement("canvas");canvas.width=sourceImage.width,canvas.height=sourceImage.height;var ctx=canvas.getContext("2d");ctx.drawImage(sourceImage,0,0,sourceImage.width,sourceImage.height);for(var imageData=ctx.getImageData(0,0,sourceImage.width,sourceImage.height),top=sourceImage.height/2,left=sourceImage.width/2,right=left,bottom=top,tempY=0;tempY<sourceImage.height;tempY++)for(var tempX=0;tempX<sourceImage.width;tempX++){var pixel=A.getPixelData(imageData,sourceImage.width,tempX,tempY);A.isWhitePixel(pixel)||(left>tempX&&(left=tempX),tempX>right&&(right=tempX+1),top>tempY&&(top=tempY),tempY>bottom&&(bottom=tempY+1))}callback({top:top,left:left,right:right,bottom:bottom})},sourceImage.src=source},A.colorOffset={red:0,green:1,blue:2,alpha:3},A.getPixelData=function(imageData,width,x,y){return{red:imageData.data[4*y*width+4*x+A.colorOffset.red],green:imageData.data[4*y*width+4*x+A.colorOffset.green],blue:imageData.data[4*y*width+4*x+A.colorOffset.blue],alpha:imageData.data[4*y*width+4*x+A.colorOffset.alpha]}},A.isWhitePixel=function(pixel){return 255===pixel.red&&255===pixel.green&&255===pixel.blue||0===pixel.alpha}}(alchemy);var alchemy=alchemy||{};!function(A){A.DEGREE_TO_RAD=Math.PI/180,A.RAD_TO_DEGREE=180/Math.PI,A.MODE_RAD=0,A.MODE_DEGREE=1;var angleMode=A.MODE_DEGREE;A.angleMode=function(mode){return"undefined"==typeof mode?angleMode:void(angleMode=mode)},A.point2d=function(x,y){return"undefined"==typeof y?{x:x[0],y:x[1]}:{x:x,y:y}},A.rotateAroundPoint=function(point,center,angle){A.angleMode()==A.MODE_DEGREE&&(angle*=A.DEGREE_TO_RAD);var x=center.x+(point.x-center.x)*Math.cos(angle)-(point.y-center.y)*Math.sin(angle),y=center.y+(point.x-center.x)*Math.sin(angle)+(point.y-center.y)*Math.cos(angle);return A.point2d(x,y)},A.closestPointOnCircle=function(center,radius,point){var c,p,v={},a={};return c=A.isArray(center)?A.point2d(center):center,p=A.isArray(point)?A.point2d(point):point,v.x=p.x-c.x,v.y=p.y-c.y,v.mag=Math.sqrt(v.x*v.x+v.y*v.y),a.x=c.x+v.x/v.mag*radius,a.y=c.y+v.y/v.mag*radius,a.dist=Math.sqrt(Math.pow(a.x-p.x,2)+Math.pow(a.y-p.y,2)),a},A.moveThroughArc=function(point,center,arcLength){var radius=Math.sqrt(Math.pow(point.x-center.x,2)+Math.pow(point.y-center.y,2)),rads=arcLength/radius,angle=A.angleMode()==A.MODE_RAD?rads:rads*A.RAD_TO_DEGREE;return A.rotateAroundPoint(point,center,angle)},A.angle=function(point,center){var angle=Math.atan2(point.y-center.y,point.x-center.x);return A.angleMode()==A.MODE_DEGREE?(angle*=A.RAD_TO_DEGREE,angle>=0?angle:angle+360):angle>=0?angle:angle+2*Math.PI},A.distance=function(a,b){return Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))},A.dist=A.distance,A.mod=function(x,n){return(x%n+n)%n},A.angleOverlap=function(z1,z2){var zone1,zone2;A.angleMode()==A.MODE_RAD?(zone1={start:z1.start*A.RAD_TO_DEGREE,end:z1.end*A.RAD_TO_DEGREE},zone2={start:z2.start*A.RAD_TO_DEGREE,end:z2.end*A.RAD_TO_DEGREE}):(zone1={start:z1.start,end:z1.end},zone2={start:z2.start,end:z2.end}),zone1.start>zone1.end&&(zone1.end=A.mod(zone1.end-zone1.start,360),zone2.start=A.mod(zone2.start-zone1.start,360),zone2.end=A.mod(zone2.end-zone1.start,360),zone1.start=0);var o=zone2.start>zone1.start&&zone2.start<zone1.end||zone2.end>zone1.start&&zone2.end<zone1.end;return o?o:(zone2.start>zone2.end&&(zone2.end=A.mod(zone2.end-zone2.start,360),zone1.start=A.mod(zone1.start-zone2.start,360),zone1.end=A.mod(zone1.end-zone2.start,360),zone2.start=0),o=zone1.start>zone2.start&&zone1.start<zone2.end||zone1.end>zone2.start&&zone1.end<zone2.end)},A.angleContain=function(z1,z2){var zone1,zone2;A.angleMode()==A.MODE_RAD?(zone1={start:z1.start*A.RAD_TO_DEGREE,end:z1.end*A.RAD_TO_DEGREE},zone2={start:z2.start*A.RAD_TO_DEGREE,end:z2.end*A.RAD_TO_DEGREE}):(zone1={start:z1.start,end:z1.end},zone2={start:z2.start,end:z2.end}),zone1.start>zone1.end&&(zone1.end=A.mod(zone1.end-zone1.start,360),zone2.start=A.mod(zone2.start-zone1.start,360),zone2.end=A.mod(zone2.end-zone1.start,360),zone1.start=0);var o=zone2.start>zone1.start&&zone2.start<zone1.end&&zone2.end>zone1.start&&zone2.end<zone1.end;return o}}(alchemy),function($){$.fn.toggleHeight=function(time,shrink){this.toggleDimension({time:time,shrink:shrink})},$.fn.toggleWidth=function(time,shrink){this.toggleDimension({time:time,shrink:shrink,dimension:width})},$.fn.toggleDimension=function(options){return options=$.extend({dimension:"height",shrink:!1,time:500},options),this.each(function(){var minDim=parseInt($(this).css("min-"+options.dimension)),shrink="undefined"!=typeof options.shrink?options.shrink:$(this)[options.dimension]()!=minDim,obj={};if(shrink)obj[options.dimension]=minDim,$(this).animate(obj,options.time);else{var maxDim=parseInt($(this).css("max-"+options.dimension));obj[options.dimension]=maxDim,$(this).animate(obj,options.time)}})},$.fn.rotate=function(degrees){var rotateCSS="rotate("+degrees+"deg)",css={"-webkit-transform":rotateCSS,"-moz-transform":rotateCSS,"-ms-transform":rotateCSS,transform:rotateCSS};return this.each(function(){$(this).css(css)})},$.fn.pagify=function(options){return this.each(function(){var ele=$(this);ele.off("foward.pagify backward.pagify"),ele.empty(),this.pagifyOptions=$.extend({width:ele.width(),height:ele.height(),pagesPerChunk:2,curPageNum:0,time:250,numPages:0,buffer:0,getPages:function(){if(10==this.numPages)return null;this.numPages+=this.pagesPerChunk;var div=$("<div>");return div.css("background-color",alchemy.randomColor()).css("overflow","hidden"),div}},options),ele.css({overflow:"hidden",width:this.pagifyOptions.width,height:this.pagifyOptions.height});var pageContainer=$("<div>");pageContainer.css({width:"100%",height:"100%"}),ele.append(pageContainer);var firstChunk=getChunk(this.pagifyOptions);pageContainer.append(firstChunk),function(pageContainer,options){var turned=!0,getChunkNum=function(pageNum){return 0===pageNum?0:parseInt(pageNum/options.pagesPerChunk)},changePage=function(mult){if(turned&&!(options.curPageNum+mult<0)){if(turned=!1,options.curPageNum+=mult,options.curPageNum>options.numPages-1-options.buffer){var nextChunk=getChunk(options);if(nextChunk){pageContainer.append(nextChunk);var newWidth=pageContainer.width()+parseInt(options.width)*options.pagesPerChunk;pageContainer.width(newWidth)}}if(options.curPageNum==options.numPages)return turned=!0,void(options.curPageNum=options.numPages-1);{var prevChunkNum;getChunkNum(options.curPageNum)}prevChunkNum=getChunkNum(1==mult?options.curPageNum-1:options.curPageNum);var tarChunk=$(pageContainer.children()[prevChunkNum]),margin=Math.ceil(parseInt(tarChunk.css("margin-left"))/options.width)*options.width-options.width*mult;tarChunk.animate({"margin-left":margin},options.time,function(){turned=!0}),pageContainer.parent().trigger("pageturn.pagify")}};pageContainer.parent().on("forward.pagify",function(){changePage(1)}),pageContainer.parent().on("backward.pagify",function(){changePage(-1)})}(pageContainer,this.pagifyOptions)})};var getChunk=function(o){var nextChunk=o.getPages();return nextChunk?(nextChunk.css({"float":"left",width:o.width*o.pagesPerChunk,height:o.height}),$(nextChunk).children().each(function(){$(this).css({height:"100%",width:o.width,"float":"left"})}),nextChunk):null};$.fn.bubble=function(o){o=$.extend({events:"click",delay:100,data:'<div style="padding:5px;">Hey! This is a bubble box</div>',"background-color":"white","border-color":"black"},o);var createBubble=function(e){$(this).off(o.events,createBubble);var container=$("<div>").addClass("bubble-container"),arrow=$("<div>").addClass("bubble-arrow"),infobox=$("<div>").addClass("bubble-infoBox");infobox.html("[object Function]"===Object.prototype.toString.call(o.data)?o.data():o.data),$("body").append(container),container.append(infobox),container.append(arrow),infobox.css("margin-left",arrow.width()-parseInt(infobox.css("border-width"))),container.css({top:e.pageY-arrow.height()/2-arrow.position().top+1,left:e.pageX-arrow.width()/2}),function(ele,container,o){var hover=!0;container.children().hover(function(){hover=!0,clearTimeout(container.timer)},function(){hover=!1,container.timer=setTimeout(function(){hover||(container.remove(),ele.on(o.events,createBubble))},o.delay)})}($(this),container,o)};return this.on(o.events,createBubble)}}(jQuery);var jQuery=jQuery||{};!function(jQuery){"use strict";var move={};move.dist=function(x1,y1,x2,y2){return Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2))},move.elementFromPoint=function(x,y){return document.elementFromPoint(x-window.pageXOffset,y-window.pageYOffset)},move.background=8,move.midground=9,move.foreground=10,move.monitoringTouchEnd=!1,move.previousTouchEnd=null,jQuery.fn.move=function(options){return this.each(function(){var ele=jQuery(this),s=jQuery.extend({x:0,y:0,regX:0,regY:0,position:"absolute",rotation:0,minX:-1/0,minY:-1/0,maxX:1/0,maxY:1/0,defaultZ:move.midground},options);ele.css({position:s.position,"z-index":s.defaultZ}),ele.origin(s.regX,s.regY),ele.data("move",s),ele.rotate(s.rotation),ele.x(s.x),ele.y(s.y),ele.addClass("moveable")})},jQuery.fn.origin=function(regX,regY){var origin=regX+"px "+regY+"px";this.css({"-webkit-transform-origin":origin,"-moz-transform-origin":origin,"-ms-transform-origin":origin,"transform-origin":origin})},jQuery.fn.rotate=function(degrees){if("undefined"!=typeof degrees){degrees%=360;var rotateCSS="rotate("+degrees+"deg)",css={"-webkit-transform":rotateCSS,"-moz-transform":rotateCSS,"-ms-transform":rotateCSS,transform:rotateCSS};return this.each(function(){jQuery(this).css(css),jQuery(this).data("move").rotation=degrees})}return this.data("move").rotation},jQuery.fn.x=function(x){if("undefined"!=typeof x){var d=this.data("move");return x=Math.max(x,d.minX),x=Math.min(x,d.maxX),d.x=x,this.css({left:x-this.data("move").regX}),this}return void 0!==this.data("move")?this.data("move").x:void 0},jQuery.fn.y=function(y){if("undefined"!=typeof y){var d=this.data("move");return y=Math.max(y,d.minY),y=Math.min(y,d.maxY),d.y=y,this.css({top:y-this.data("move").regY}),this}return void 0!==this.data("move")?this.data("move").y:void 0},jQuery.fn.cords=function(cords){return"undefined"!=typeof cords?(this.y(cords.y),this.x(cords.x),this):{x:this.x(),y:this.y()}},jQuery.fn.regX=function(regX){return"undefined"!=typeof regX?(this.data("move").regX=regX,this.origin(this.data("move").regX,this.data("move").regY),this):this.data("move").regX},jQuery.fn.regY=function(regY){return"undefined"!=typeof regY?(this.data("move").regY=regY,this.origin(this.data("move").regX,this.data("move").regY),this):this.data("move").regY},jQuery.fn.maxX=function(maxX){return"undefined"!=typeof maxX?(this.data("move").maxX=maxX,this.x(this.x()),this):this.data("move").maxX},jQuery.fn.minX=function(minX){return"undefined"!=typeof minX?(this.data("move").minX=minX,this.x(this.x()),this):this.data("move").minX},jQuery.fn.maxY=function(maxY){return"undefined"!=typeof maxY?(this.data("move").maxY=maxY,this.y(this.y()),this):this.data("move").maxY},jQuery.fn.minY=function(minY){return"undefined"!=typeof minY?(this.data("move").minY=minY,this.y(this.y()),this):this.data("move").minY},jQuery.fn.opacity=function(o){return this.css({opacity:o,filter:"alpha(opacity="+(100*o).toString()+")"})},jQuery.fn.background=function(){return this.each(function(){jQuery(this).css({"z-index":move.background})})},jQuery.fn.midground=function(){return this.each(function(){jQuery(this).css({"z-index":move.midground})})},jQuery.fn.foreground=function(){return this.each(function(){jQuery(this).css({"z-index":move.foreground})})},jQuery.fn.defaultground=function(){return this.each(function(){jQuery(this).css({"z-index":jQuery(this).data("move").defaultZ})})};var monitorTouchEnd=function(){move.monitoringTouchEnd||(jQuery("html").on("touchend",function(evt){move.previousTouchEnd=evt}),move.monitoringTouchEnd=!0)};jQuery.fn.drag=function(options){var opt=jQuery.extend({dragpick:!0,smoothDistance:0,smoothMouse:!1,smoothTouch:!1},options);return monitorTouchEnd(),this.each(function(){jQuery(this).attr("draggable",!1),jQuery(this).data("move").drag=!0;var startDragging=function(evt){var ele=jQuery(this),e=jQuery.extend(evt,{type:"dragstart"});if(ele.trigger(e),!evt.pageX){if(!evt.originalEvent.touches[0])return!1;evt.pageX=evt.originalEvent.touches[0].pageX,evt.pageY=evt.originalEvent.touches[0].pageY}var dX=ele.x()-evt.pageX,dY=ele.y()-evt.pageY,drag=function(evt){evt.pageX||(evt.pageX=evt.originalEvent.touches[0].pageX,evt.pageY=evt.originalEvent.touches[0].pageY),evt.preventDefault();var skip=!1;if(move.previousTouchEnd){var endX=move.previousTouchEnd.originalEvent.changedTouches[0].pageX,endY=move.previousTouchEnd.originalEvent.changedTouches[0].pageY;evt.pageX==endX&&evt.pageY==endY&&(skip=!0)}if(!skip){var smooth,nPos={x:evt.pageX+dX,y:evt.pageY+dY},dragDis=Math.sqrt(Math.pow(nPos.x-ele.x(),2)+Math.pow(nPos.y-ele.y(),2));smooth="undefined"!=typeof TouchEvent&&evt.originalEvent instanceof TouchEvent?opt.smoothTouch:opt.smoothMouse,(!smooth||dragDis<opt.smoothDistance)&&(ele.x(nPos.x),ele.y(nPos.y));var e=jQuery.extend(evt,{type:"dragstep"});ele.trigger(e)}return evt.stopPropagation(),!1},dragEnd=function(evt){jQuery("html").off("mousemove touchmove",drag),jQuery("html").off("mouseup touchend",dragEnd);var e=jQuery.extend(evt,{type:"dragstop"});ele.trigger(e)};jQuery("html").on("mousemove touchmove",drag),jQuery("html").on("mouseup touchend",dragEnd)};jQuery(this).on("drag.move",startDragging),jQuery(this).on("mousedown touchstart",function(evt){evt.preventDefault(),jQuery("html").trigger(evt);var ele=jQuery(this);return opt.dragpick&&(evt.pageX||(evt.pageX=evt.originalEvent.touches[0].pageX,evt.pageY=evt.originalEvent.touches[0].pageY),ele=pointpick(evt.pageX,evt.pageY)),ele&&startDragging.call(ele,evt),!1})})};var pointpick=function(x,y){for(var closestEle,ele,hidden=[],minDist=1/0;(ele=move.elementFromPoint(x,y))&&"BODY"!=ele.tagName&&"HTML"!=ele.tagName&&(ele=jQuery(ele),ele.hasClass("moveable")&&ele.data("move").drag);){var relX=x-ele.parent().offset().left,relY=y-ele.parent().offset().top,dist=move.dist(ele.x(),ele.y(),relX,relY);minDist>dist&&(closestEle=ele,minDist=dist),ele.hide(),hidden.push(ele)}return jQuery.each(hidden,function(index,value){value.show()}),jQuery(".moveable").defaultground(),closestEle&&closestEle.foreground(),closestEle}}(jQuery),function(window,document,undefined){"use strict";function toPX(element,attribute,value){var left,rsLeft=element.runtimeStyle&&element.runtimeStyle[attribute],style=element.style;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(value)&&/^-?\d/.test(value)&&(left=style.left,rsLeft&&(element.runtimeStyle.left=element.currentStyle.left),style.left="fontSize"===attribute?"1em":value||0,value=style.pixelLeft+"px",style.left=left,rsLeft&&(element.runtimeStyle.left=rsLeft)),/^(thin|medium|thick)$/i.test(value)?value:Math.round(parseFloat(value))+"px"}function asInt(val){return parseInt(val,10)}function parseBackgroundSizePosition(value,element,attribute,index){if(value=(value||"").split(","),value=value[index||0]||value[0]||"auto",value=_html2canvas.Util.trimText(value).split(" "),"backgroundSize"!==attribute||value[0]&&!value[0].match(/cover|contain|auto/)){if(value[0]=-1===value[0].indexOf("%")?toPX(element,attribute+"X",value[0]):value[0],value[1]===undefined){if("backgroundSize"===attribute)return value[1]="auto",value;value[1]=value[0]}value[1]=-1===value[1].indexOf("%")?toPX(element,attribute+"Y",value[1]):value[1]}else;return value}function backgroundBoundsFactory(prop,el,bounds,image,imageIndex,backgroundSize){var topPos,left,percentage,val,bgposition=_html2canvas.Util.getCSS(el,prop,imageIndex);if(1===bgposition.length&&(val=bgposition[0],bgposition=[],bgposition[0]=val,bgposition[1]=val),-1!==bgposition[0].toString().indexOf("%"))percentage=parseFloat(bgposition[0])/100,left=bounds.width*percentage,"backgroundSize"!==prop&&(left-=(backgroundSize||image).width*percentage);else if("backgroundSize"===prop)if("auto"===bgposition[0])left=image.width;else if(/contain|cover/.test(bgposition[0])){var resized=_html2canvas.Util.resizeBounds(image.width,image.height,bounds.width,bounds.height,bgposition[0]);left=resized.width,topPos=resized.height}else left=parseInt(bgposition[0],10);else left=parseInt(bgposition[0],10);return"auto"===bgposition[1]?topPos=left/image.width*image.height:-1!==bgposition[1].toString().indexOf("%")?(percentage=parseFloat(bgposition[1])/100,topPos=bounds.height*percentage,"backgroundSize"!==prop&&(topPos-=(backgroundSize||image).height*percentage)):topPos=parseInt(bgposition[1],10),[left,topPos]}function h2cRenderContext(width,height){var storage=[];return{storage:storage,width:width,height:height,clip:function(){storage.push({type:"function",name:"clip",arguments:arguments})},translate:function(){storage.push({type:"function",name:"translate",arguments:arguments})},fill:function(){storage.push({type:"function",name:"fill",arguments:arguments})},save:function(){storage.push({type:"function",name:"save",arguments:arguments})},restore:function(){storage.push({type:"function",name:"restore",arguments:arguments})},fillRect:function(){storage.push({type:"function",name:"fillRect",arguments:arguments})},createPattern:function(){storage.push({type:"function",name:"createPattern",arguments:arguments})},drawShape:function(){var shape=[];return storage.push({type:"function",name:"drawShape",arguments:shape}),{moveTo:function(){shape.push({name:"moveTo",arguments:arguments})},lineTo:function(){shape.push({name:"lineTo",arguments:arguments})},arcTo:function(){shape.push({name:"arcTo",arguments:arguments})},bezierCurveTo:function(){shape.push({name:"bezierCurveTo",arguments:arguments})},quadraticCurveTo:function(){shape.push({name:"quadraticCurveTo",arguments:arguments})}}},drawImage:function(){storage.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){storage.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(variable,value){return storage.push({type:"variable",name:variable,arguments:value}),value}}}function h2czContext(zindex){return{zindex:zindex,children:[]}}var previousElement,computedCSS,_html2canvas={};_html2canvas.Util={},_html2canvas.Util.log=function(a){_html2canvas.logging&&window.console&&window.console.log&&window.console.log(a)},_html2canvas.Util.trimText=function(isNative){return function(input){return isNative?isNative.apply(input):((input||"")+"").replace(/^\s+|\s+$/g,"")}}(String.prototype.trim),_html2canvas.Util.asFloat=function(v){return parseFloat(v)},function(){var TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g;_html2canvas.Util.parseTextShadows=function(value){if(!value||"none"===value)return[];for(var shadows=value.match(TEXT_SHADOW_PROPERTY),results=[],i=0;shadows&&i<shadows.length;i++){var s=shadows[i].match(TEXT_SHADOW_VALUES);results.push({color:s[0],offsetX:s[1]?s[1].replace("px",""):0,offsetY:s[2]?s[2].replace("px",""):0,blur:s[3]?s[3].replace("px",""):0})}return results}}(),_html2canvas.Util.parseBackgroundImage=function(value){var method,definition,prefix,prefix_i,block,c,quote,args,whitespace=" \r\n	",results=[],mode=0,numParen=0,appendResult=function(){method&&('"'===definition.substr(0,1)&&(definition=definition.substr(1,definition.length-2)),definition&&args.push(definition),"-"===method.substr(0,1)&&(prefix_i=method.indexOf("-",1)+1)>0&&(prefix=method.substr(0,prefix_i),method=method.substr(prefix_i)),results.push({prefix:prefix,method:method.toLowerCase(),value:block,args:args})),args=[],method=prefix=definition=block=""};appendResult();for(var i=0,ii=value.length;ii>i;i++)if(c=value[i],!(0===mode&&whitespace.indexOf(c)>-1)){switch(c){case'"':quote?quote===c&&(quote=null):quote=c;break;case"(":if(quote)break;if(0===mode){mode=1,block+=c;continue}numParen++;break;case")":if(quote)break;if(1===mode){if(0===numParen){mode=0,block+=c,appendResult();continue}numParen--}break;case",":if(quote)break;if(0===mode){appendResult();continue}if(1===mode&&0===numParen&&!method.match(/^url$/i)){args.push(definition),definition="",block+=c;continue}}block+=c,0===mode?method+=c:definition+=c}return appendResult(),results},_html2canvas.Util.Bounds=function(element){var clientRect,bounds={};return element.getBoundingClientRect&&(clientRect=element.getBoundingClientRect(),bounds.top=clientRect.top,bounds.bottom=clientRect.bottom||clientRect.top+clientRect.height,bounds.left=clientRect.left,bounds.width=element.offsetWidth,bounds.height=element.offsetHeight),bounds},_html2canvas.Util.OffsetBounds=function(element){var parent=element.offsetParent?_html2canvas.Util.OffsetBounds(element.offsetParent):{top:0,left:0};return{top:element.offsetTop+parent.top,bottom:element.offsetTop+element.offsetHeight+parent.top,left:element.offsetLeft+parent.left,width:element.offsetWidth,height:element.offsetHeight}},_html2canvas.Util.getCSS=function(element,attribute,index){previousElement!==element&&(computedCSS=document.defaultView.getComputedStyle(element,null));var value=computedCSS[attribute];if(/^background(Size|Position)$/.test(attribute))return parseBackgroundSizePosition(value,element,attribute,index);if(/border(Top|Bottom)(Left|Right)Radius/.test(attribute)){var arr=value.split(" ");return arr.length<=1&&(arr[1]=arr[0]),arr.map(asInt)}return value},_html2canvas.Util.resizeBounds=function(current_width,current_height,target_width,target_height,stretch_mode){var output_width,output_height,target_ratio=target_width/target_height,current_ratio=current_width/current_height;return stretch_mode&&"auto"!==stretch_mode?current_ratio>target_ratio^"contain"===stretch_mode?(output_height=target_height,output_width=target_height*current_ratio):(output_width=target_width,output_height=target_width/current_ratio):(output_width=target_width,output_height=target_height),{width:output_width,height:output_height}},_html2canvas.Util.BackgroundPosition=function(el,bounds,image,imageIndex,backgroundSize){var result=backgroundBoundsFactory("backgroundPosition",el,bounds,image,imageIndex,backgroundSize);return{left:result[0],top:result[1]}},_html2canvas.Util.BackgroundSize=function(el,bounds,image,imageIndex){var result=backgroundBoundsFactory("backgroundSize",el,bounds,image,imageIndex);return{width:result[0],height:result[1]}},_html2canvas.Util.Extend=function(options,defaults){for(var key in options)options.hasOwnProperty(key)&&(defaults[key]=options[key]);return defaults},_html2canvas.Util.Children=function(elem){var children;try{children=elem.nodeName&&"IFRAME"===elem.nodeName.toUpperCase()?elem.contentDocument||elem.contentWindow.document:function(array){var ret=[];return null!==array&&!function(first,second){var i=first.length,j=0;if("number"==typeof second.length)for(var l=second.length;l>j;j++)first[i++]=second[j];else for(;second[j]!==undefined;)first[i++]=second[j++];return first.length=i,first}(ret,array),ret}(elem.childNodes)}catch(ex){_html2canvas.Util.log("html2canvas.Util.Children failed with exception: "+ex.message),children=[]}return children},_html2canvas.Util.isTransparent=function(backgroundColor){return"transparent"===backgroundColor||"rgba(0, 0, 0, 0)"===backgroundColor},_html2canvas.Util.Font=function(){var fontData={};return function(font,fontSize,doc){if(fontData[font+"-"+fontSize]!==undefined)return fontData[font+"-"+fontSize];var baseline,middle,metricsObj,container=doc.createElement("div"),img=doc.createElement("img"),span=doc.createElement("span"),sampleText="Hidden Text";return container.style.visibility="hidden",container.style.fontFamily=font,container.style.fontSize=fontSize,container.style.margin=0,container.style.padding=0,doc.body.appendChild(container),img.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=",img.width=1,img.height=1,img.style.margin=0,img.style.padding=0,img.style.verticalAlign="baseline",span.style.fontFamily=font,span.style.fontSize=fontSize,span.style.margin=0,span.style.padding=0,span.appendChild(doc.createTextNode(sampleText)),container.appendChild(span),container.appendChild(img),baseline=img.offsetTop-span.offsetTop+1,container.removeChild(span),container.appendChild(doc.createTextNode(sampleText)),container.style.lineHeight="normal",img.style.verticalAlign="super",middle=img.offsetTop-container.offsetTop+1,metricsObj={baseline:baseline,lineWidth:1,middle:middle},fontData[font+"-"+fontSize]=metricsObj,doc.body.removeChild(container),metricsObj
}}(),function(){function addScrollStops(grad){return function(colorStop){try{grad.addColorStop(colorStop.stop,colorStop.color)}catch(e){Util.log(["failed to add color stop: ",e,"; tried to add: ",colorStop])}}}var Util=_html2canvas.Util,Generate={};_html2canvas.Generate=Generate;var reGradients=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];Generate.parseGradient=function(css,bounds){var gradient,i,m1,stop,m2,m2Len,step,m3,tl,tr,br,bl,len=reGradients.length;for(i=0;len>i&&!(m1=css.match(reGradients[i]));i+=1);if(m1)switch(m1[1]){case"-webkit-linear-gradient":case"-o-linear-gradient":if(gradient={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},m2=m1[2].match(/\w+/g))for(m2Len=m2.length,i=0;m2Len>i;i+=1)switch(m2[i]){case"top":gradient.y0=0,gradient.y1=bounds.height;break;case"right":gradient.x0=bounds.width,gradient.x1=0;break;case"bottom":gradient.y0=bounds.height,gradient.y1=0;break;case"left":gradient.x0=0,gradient.x1=bounds.width}if(null===gradient.x0&&null===gradient.x1&&(gradient.x0=gradient.x1=bounds.width/2),null===gradient.y0&&null===gradient.y1&&(gradient.y0=gradient.y1=bounds.height/2),m2=m1[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(m2Len=m2.length,step=1/Math.max(m2Len-1,1),i=0;m2Len>i;i+=1)m3=m2[i].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),m3[2]?(stop=parseFloat(m3[2]),stop/="%"===m3[3]?100:bounds.width):stop=i*step,gradient.colorStops.push({color:m3[1],stop:stop});break;case"-webkit-gradient":if(gradient={type:"radial"===m1[2]?"circle":m1[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},m2=m1[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/),m2&&(gradient.x0=m2[1]*bounds.width/100,gradient.y0=m2[2]*bounds.height/100,gradient.x1=m2[3]*bounds.width/100,gradient.y1=m2[4]*bounds.height/100),m2=m1[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g))for(m2Len=m2.length,i=0;m2Len>i;i+=1)m3=m2[i].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),stop=parseFloat(m3[2]),"from"===m3[1]&&(stop=0),"to"===m3[1]&&(stop=1),gradient.colorStops.push({color:m3[3],stop:stop});break;case"-moz-linear-gradient":if(gradient={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]},m2=m1[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),m2&&(gradient.x0=m2[1]*bounds.width/100,gradient.y0=m2[2]*bounds.height/100,gradient.x1=bounds.width-gradient.x0,gradient.y1=bounds.height-gradient.y0),m2=m1[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g))for(m2Len=m2.length,step=1/Math.max(m2Len-1,1),i=0;m2Len>i;i+=1)m3=m2[i].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/),m3[2]?(stop=parseFloat(m3[2]),m3[3]&&(stop/=100)):stop=i*step,gradient.colorStops.push({color:m3[1],stop:stop});break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":if(gradient={type:"circle",x0:0,y0:0,x1:bounds.width,y1:bounds.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},m2=m1[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),m2&&(gradient.cx=m2[1]*bounds.width/100,gradient.cy=m2[2]*bounds.height/100),m2=m1[3].match(/\w+/),m3=m1[4].match(/[a-z\-]*/),m2&&m3)switch(m3[0]){case"farthest-corner":case"cover":case"":tl=Math.sqrt(Math.pow(gradient.cx,2)+Math.pow(gradient.cy,2)),tr=Math.sqrt(Math.pow(gradient.cx,2)+Math.pow(gradient.y1-gradient.cy,2)),br=Math.sqrt(Math.pow(gradient.x1-gradient.cx,2)+Math.pow(gradient.y1-gradient.cy,2)),bl=Math.sqrt(Math.pow(gradient.x1-gradient.cx,2)+Math.pow(gradient.cy,2)),gradient.rx=gradient.ry=Math.max(tl,tr,br,bl);break;case"closest-corner":tl=Math.sqrt(Math.pow(gradient.cx,2)+Math.pow(gradient.cy,2)),tr=Math.sqrt(Math.pow(gradient.cx,2)+Math.pow(gradient.y1-gradient.cy,2)),br=Math.sqrt(Math.pow(gradient.x1-gradient.cx,2)+Math.pow(gradient.y1-gradient.cy,2)),bl=Math.sqrt(Math.pow(gradient.x1-gradient.cx,2)+Math.pow(gradient.cy,2)),gradient.rx=gradient.ry=Math.min(tl,tr,br,bl);break;case"farthest-side":"circle"===m2[0]?gradient.rx=gradient.ry=Math.max(gradient.cx,gradient.cy,gradient.x1-gradient.cx,gradient.y1-gradient.cy):(gradient.type=m2[0],gradient.rx=Math.max(gradient.cx,gradient.x1-gradient.cx),gradient.ry=Math.max(gradient.cy,gradient.y1-gradient.cy));break;case"closest-side":case"contain":"circle"===m2[0]?gradient.rx=gradient.ry=Math.min(gradient.cx,gradient.cy,gradient.x1-gradient.cx,gradient.y1-gradient.cy):(gradient.type=m2[0],gradient.rx=Math.min(gradient.cx,gradient.x1-gradient.cx),gradient.ry=Math.min(gradient.cy,gradient.y1-gradient.cy))}if(m2=m1[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(m2Len=m2.length,step=1/Math.max(m2Len-1,1),i=0;m2Len>i;i+=1)m3=m2[i].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),m3[2]?(stop=parseFloat(m3[2]),stop/="%"===m3[3]?100:bounds.width):stop=i*step,gradient.colorStops.push({color:m3[1],stop:stop})}return gradient},Generate.Gradient=function(src,bounds){if(0!==bounds.width&&0!==bounds.height){var gradient,grad,canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");if(canvas.width=bounds.width,canvas.height=bounds.height,gradient=_html2canvas.Generate.parseGradient(src,bounds))switch(gradient.type){case"linear":grad=ctx.createLinearGradient(gradient.x0,gradient.y0,gradient.x1,gradient.y1),gradient.colorStops.forEach(addScrollStops(grad)),ctx.fillStyle=grad,ctx.fillRect(0,0,bounds.width,bounds.height);break;case"circle":grad=ctx.createRadialGradient(gradient.cx,gradient.cy,0,gradient.cx,gradient.cy,gradient.rx),gradient.colorStops.forEach(addScrollStops(grad)),ctx.fillStyle=grad,ctx.fillRect(0,0,bounds.width,bounds.height);break;case"ellipse":var canvasRadial=document.createElement("canvas"),ctxRadial=canvasRadial.getContext("2d"),ri=Math.max(gradient.rx,gradient.ry),di=2*ri;canvasRadial.width=canvasRadial.height=di,grad=ctxRadial.createRadialGradient(gradient.rx,gradient.ry,0,gradient.rx,gradient.ry,ri),gradient.colorStops.forEach(addScrollStops(grad)),ctxRadial.fillStyle=grad,ctxRadial.fillRect(0,0,di,di),ctx.fillStyle=gradient.colorStops[gradient.colorStops.length-1].color,ctx.fillRect(0,0,canvas.width,canvas.height),ctx.drawImage(canvasRadial,gradient.cx-gradient.rx,gradient.cy-gradient.ry,2*gradient.rx,2*gradient.ry)}return canvas}},Generate.ListAlpha=function(number){var modulus,tmp="";do modulus=number%26,tmp=String.fromCharCode(modulus+64)+tmp,number/=26;while(26*number>26);return tmp},Generate.ListRoman=function(number){var v,romanArray=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],decimal=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],roman="",len=romanArray.length;if(0>=number||number>=4e3)return number;for(v=0;len>v;v+=1)for(;number>=decimal[v];)number-=decimal[v],roman+=romanArray[v];return roman}}(),_html2canvas.Parse=function(images,options){function documentWidth(){return Math.max(Math.max(doc.body.scrollWidth,doc.documentElement.scrollWidth),Math.max(doc.body.offsetWidth,doc.documentElement.offsetWidth),Math.max(doc.body.clientWidth,doc.documentElement.clientWidth))}function documentHeight(){return Math.max(Math.max(doc.body.scrollHeight,doc.documentElement.scrollHeight),Math.max(doc.body.offsetHeight,doc.documentElement.offsetHeight),Math.max(doc.body.clientHeight,doc.documentElement.clientHeight))}function getCSSInt(element,attribute){var val=parseInt(getCSS(element,attribute),10);return isNaN(val)?0:val}function renderRect(ctx,x,y,w,h,bgcolor){"transparent"!==bgcolor&&(ctx.setVariable("fillStyle",bgcolor),ctx.fillRect(x,y,w,h),numDraws+=1)}function capitalize(m,p1,p2){return m.length>0?p1+p2.toUpperCase():void 0}function textTransform(text,transform){switch(transform){case"lowercase":return text.toLowerCase();case"capitalize":return text.replace(/(^|\s|:|-|\(|\))([a-z])/g,capitalize);case"uppercase":return text.toUpperCase();default:return text}}function noLetterSpacing(letter_spacing){return/^(normal|none|0px)$/.test(letter_spacing)}function drawText(currentText,x,y,ctx){null!==currentText&&Util.trimText(currentText).length>0&&(ctx.fillText(currentText,x,y),numDraws+=1)}function setTextVariables(ctx,el,text_decoration,color){var align=!1,bold=getCSS(el,"fontWeight"),family=getCSS(el,"fontFamily"),size=getCSS(el,"fontSize"),shadows=Util.parseTextShadows(getCSS(el,"textShadow"));switch(parseInt(bold,10)){case 401:bold="bold";break;case 400:bold="normal"}return ctx.setVariable("fillStyle",color),ctx.setVariable("font",[getCSS(el,"fontStyle"),getCSS(el,"fontVariant"),bold,size,family].join(" ")),ctx.setVariable("textAlign",align?"right":"left"),shadows.length&&(ctx.setVariable("shadowColor",shadows[0].color),ctx.setVariable("shadowOffsetX",shadows[0].offsetX),ctx.setVariable("shadowOffsetY",shadows[0].offsetY),ctx.setVariable("shadowBlur",shadows[0].blur)),"none"!==text_decoration?Util.Font(family,size,doc):void 0}function renderTextDecoration(ctx,text_decoration,bounds,metrics,color){switch(text_decoration){case"underline":renderRect(ctx,bounds.left,Math.round(bounds.top+metrics.baseline+metrics.lineWidth),bounds.width,1,color);break;case"overline":renderRect(ctx,bounds.left,Math.round(bounds.top),bounds.width,1,color);break;case"line-through":renderRect(ctx,bounds.left,Math.ceil(bounds.top+metrics.middle+metrics.lineWidth),bounds.width,1,color)}}function getTextBounds(state,text,textDecoration,isLast,transform){var bounds;if(support.rangeBounds&&!transform)("none"!==textDecoration||0!==Util.trimText(text).length)&&(bounds=textRangeBounds(text,state.node,state.textOffset)),state.textOffset+=text.length;else if(state.node&&"string"==typeof state.node.nodeValue){var newTextNode=isLast?state.node.splitText(text.length):null;bounds=textWrapperBounds(state.node,transform),state.node=newTextNode}return bounds}function textRangeBounds(text,textNode,textOffset){var range=doc.createRange();return range.setStart(textNode,textOffset),range.setEnd(textNode,textOffset+text.length),range.getBoundingClientRect()}function textWrapperBounds(oldTextNode,transform){var parent=oldTextNode.parentNode,wrapElement=doc.createElement("wrapper"),backupText=oldTextNode.cloneNode(!0);wrapElement.appendChild(oldTextNode.cloneNode(!0)),parent.replaceChild(wrapElement,oldTextNode);var bounds=transform?Util.OffsetBounds(wrapElement):Util.Bounds(wrapElement);return parent.replaceChild(backupText,wrapElement),bounds}function renderText(el,textNode,stack){var metrics,textList,ctx=stack.ctx,color=getCSS(el,"color"),textDecoration=getCSS(el,"textDecoration"),textAlign=getCSS(el,"textAlign"),state={node:textNode,textOffset:0};Util.trimText(textNode.nodeValue).length>0&&(textNode.nodeValue=textTransform(textNode.nodeValue,getCSS(el,"textTransform")),textAlign=textAlign.replace(["-webkit-auto"],["auto"]),textList=textNode.nodeValue.split(!options.letterRendering&&/^(left|right|justify|auto)$/.test(textAlign)&&noLetterSpacing(getCSS(el,"letterSpacing"))?/(\b| )/:""),metrics=setTextVariables(ctx,el,textDecoration,color),options.chinese&&textList.forEach(function(word,index){/.*[\u4E00-\u9FA5].*$/.test(word)&&(word=word.split(""),word.unshift(index,1),textList.splice.apply(textList,word))}),textList.forEach(function(text,index){var bounds=getTextBounds(state,text,textDecoration,index<textList.length-1,stack.transform.matrix);bounds&&(drawText(text,bounds.left,bounds.bottom,ctx),renderTextDecoration(ctx,textDecoration,bounds,metrics,color))}))}function listPosition(element,val){var originalType,bounds,boundElement=doc.createElement("boundelement");return boundElement.style.display="inline",originalType=element.style.listStyleType,element.style.listStyleType="none",boundElement.appendChild(doc.createTextNode(val)),element.insertBefore(boundElement,element.firstChild),bounds=Util.Bounds(boundElement),element.removeChild(boundElement),element.style.listStyleType=originalType,bounds}function elementIndex(el){var i=-1,count=1,childs=el.parentNode.childNodes;if(el.parentNode){for(;childs[++i]!==el;)1===childs[i].nodeType&&count++;return count}return-1}function listItemText(element,type){var text,currentIndex=elementIndex(element);switch(type){case"decimal":text=currentIndex;break;case"decimal-leading-zero":text=1===currentIndex.toString().length?currentIndex="0"+currentIndex.toString():currentIndex.toString();break;case"upper-roman":text=_html2canvas.Generate.ListRoman(currentIndex);break;case"lower-roman":text=_html2canvas.Generate.ListRoman(currentIndex).toLowerCase();break;case"lower-alpha":text=_html2canvas.Generate.ListAlpha(currentIndex).toLowerCase();break;case"upper-alpha":text=_html2canvas.Generate.ListAlpha(currentIndex)}return text+". "}function renderListItem(element,stack,elBounds){var x,text,listBounds,ctx=stack.ctx,type=getCSS(element,"listStyleType");if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(type)){if(text=listItemText(element,type),listBounds=listPosition(element,text),setTextVariables(ctx,element,"none",getCSS(element,"color")),"inside"!==getCSS(element,"listStylePosition"))return;ctx.setVariable("textAlign","left"),x=elBounds.left,drawText(text,x,listBounds.bottom,ctx)}}function loadImage(src){var img=images[src];return img&&img.succeeded===!0?img.img:!1}function clipBounds(src,dst){var x=Math.max(src.left,dst.left),y=Math.max(src.top,dst.top),x2=Math.min(src.left+src.width,dst.left+dst.width),y2=Math.min(src.top+src.height,dst.top+dst.height);return{left:x,top:y,width:x2-x,height:y2-y}}function setZ(element,stack,parentStack){var newContext,isPositioned="static"!==stack.cssPosition,zIndex=isPositioned?getCSS(element,"zIndex"):"auto",opacity=getCSS(element,"opacity"),isFloated="none"!==getCSS(element,"cssFloat");stack.zIndex=newContext=h2czContext(zIndex),newContext.isPositioned=isPositioned,newContext.isFloated=isFloated,newContext.opacity=opacity,newContext.ownStacking="auto"!==zIndex||1>opacity,parentStack&&parentStack.zIndex.children.push(stack)}function renderImage(ctx,element,image,bounds,borders){var paddingLeft=getCSSInt(element,"paddingLeft"),paddingTop=getCSSInt(element,"paddingTop"),paddingRight=getCSSInt(element,"paddingRight"),paddingBottom=getCSSInt(element,"paddingBottom");drawImage(ctx,image,0,0,image.width,image.height,bounds.left+paddingLeft+borders[3].width,bounds.top+paddingTop+borders[0].width,bounds.width-(borders[1].width+borders[3].width+paddingLeft+paddingRight),bounds.height-(borders[0].width+borders[2].width+paddingTop+paddingBottom))}function getBorderData(element){return["Top","Right","Bottom","Left"].map(function(side){return{width:getCSSInt(element,"border"+side+"Width"),color:getCSS(element,"border"+side+"Color")}})}function getBorderRadiusData(element){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(side){return getCSS(element,"border"+side+"Radius")})}function bezierCurve(start,startControl,endControl,end){var lerp=function(a,b,t){return{x:a.x+(b.x-a.x)*t,y:a.y+(b.y-a.y)*t}};return{start:start,startControl:startControl,endControl:endControl,end:end,subdivide:function(t){var ab=lerp(start,startControl,t),bc=lerp(startControl,endControl,t),cd=lerp(endControl,end,t),abbc=lerp(ab,bc,t),bccd=lerp(bc,cd,t),dest=lerp(abbc,bccd,t);return[bezierCurve(start,ab,abbc,dest),bezierCurve(dest,bccd,cd,end)]},curveTo:function(borderArgs){borderArgs.push(["bezierCurve",startControl.x,startControl.y,endControl.x,endControl.y,end.x,end.y])},curveToReversed:function(borderArgs){borderArgs.push(["bezierCurve",endControl.x,endControl.y,startControl.x,startControl.y,start.x,start.y])}}}function parseCorner(borderArgs,radius1,radius2,corner1,corner2,x,y){radius1[0]>0||radius1[1]>0?(borderArgs.push(["line",corner1[0].start.x,corner1[0].start.y]),corner1[0].curveTo(borderArgs),corner1[1].curveTo(borderArgs)):borderArgs.push(["line",x,y]),(radius2[0]>0||radius2[1]>0)&&borderArgs.push(["line",corner2[0].start.x,corner2[0].start.y])}function drawSide(borderData,radius1,radius2,outer1,inner1,outer2,inner2){var borderArgs=[];return radius1[0]>0||radius1[1]>0?(borderArgs.push(["line",outer1[1].start.x,outer1[1].start.y]),outer1[1].curveTo(borderArgs)):borderArgs.push(["line",borderData.c1[0],borderData.c1[1]]),radius2[0]>0||radius2[1]>0?(borderArgs.push(["line",outer2[0].start.x,outer2[0].start.y]),outer2[0].curveTo(borderArgs),borderArgs.push(["line",inner2[0].end.x,inner2[0].end.y]),inner2[0].curveToReversed(borderArgs)):(borderArgs.push(["line",borderData.c2[0],borderData.c2[1]]),borderArgs.push(["line",borderData.c3[0],borderData.c3[1]])),radius1[0]>0||radius1[1]>0?(borderArgs.push(["line",inner1[1].end.x,inner1[1].end.y]),inner1[1].curveToReversed(borderArgs)):borderArgs.push(["line",borderData.c4[0],borderData.c4[1]]),borderArgs}function calculateCurvePoints(bounds,borderRadius,borders){var x=bounds.left,y=bounds.top,width=bounds.width,height=bounds.height,tlh=borderRadius[0][0],tlv=borderRadius[0][1],trh=borderRadius[1][0],trv=borderRadius[1][1],brh=borderRadius[2][0],brv=borderRadius[2][1],blh=borderRadius[3][0],blv=borderRadius[3][1],topWidth=width-trh,rightHeight=height-brv,bottomWidth=width-brh,leftHeight=height-blv;return{topLeftOuter:getCurvePoints(x,y,tlh,tlv).topLeft.subdivide(.5),topLeftInner:getCurvePoints(x+borders[3].width,y+borders[0].width,Math.max(0,tlh-borders[3].width),Math.max(0,tlv-borders[0].width)).topLeft.subdivide(.5),topRightOuter:getCurvePoints(x+topWidth,y,trh,trv).topRight.subdivide(.5),topRightInner:getCurvePoints(x+Math.min(topWidth,width+borders[3].width),y+borders[0].width,topWidth>width+borders[3].width?0:trh-borders[3].width,trv-borders[0].width).topRight.subdivide(.5),bottomRightOuter:getCurvePoints(x+bottomWidth,y+rightHeight,brh,brv).bottomRight.subdivide(.5),bottomRightInner:getCurvePoints(x+Math.min(bottomWidth,width+borders[3].width),y+Math.min(rightHeight,height+borders[0].width),Math.max(0,brh-borders[1].width),Math.max(0,brv-borders[2].width)).bottomRight.subdivide(.5),bottomLeftOuter:getCurvePoints(x,y+leftHeight,blh,blv).bottomLeft.subdivide(.5),bottomLeftInner:getCurvePoints(x+borders[3].width,y+leftHeight,Math.max(0,blh-borders[3].width),Math.max(0,blv-borders[2].width)).bottomLeft.subdivide(.5)}}function getBorderClip(element,borderPoints,borders,radius,bounds){var backgroundClip=getCSS(element,"backgroundClip"),borderArgs=[];switch(backgroundClip){case"content-box":case"padding-box":parseCorner(borderArgs,radius[0],radius[1],borderPoints.topLeftInner,borderPoints.topRightInner,bounds.left+borders[3].width,bounds.top+borders[0].width),parseCorner(borderArgs,radius[1],radius[2],borderPoints.topRightInner,borderPoints.bottomRightInner,bounds.left+bounds.width-borders[1].width,bounds.top+borders[0].width),parseCorner(borderArgs,radius[2],radius[3],borderPoints.bottomRightInner,borderPoints.bottomLeftInner,bounds.left+bounds.width-borders[1].width,bounds.top+bounds.height-borders[2].width),parseCorner(borderArgs,radius[3],radius[0],borderPoints.bottomLeftInner,borderPoints.topLeftInner,bounds.left+borders[3].width,bounds.top+bounds.height-borders[2].width);break;default:parseCorner(borderArgs,radius[0],radius[1],borderPoints.topLeftOuter,borderPoints.topRightOuter,bounds.left,bounds.top),parseCorner(borderArgs,radius[1],radius[2],borderPoints.topRightOuter,borderPoints.bottomRightOuter,bounds.left+bounds.width,bounds.top),parseCorner(borderArgs,radius[2],radius[3],borderPoints.bottomRightOuter,borderPoints.bottomLeftOuter,bounds.left+bounds.width,bounds.top+bounds.height),parseCorner(borderArgs,radius[3],radius[0],borderPoints.bottomLeftOuter,borderPoints.topLeftOuter,bounds.left,bounds.top+bounds.height)}return borderArgs}function parseBorders(element,bounds,borders){var borderSide,bx,by,bw,bh,borderArgs,x=bounds.left,y=bounds.top,width=bounds.width,height=bounds.height,borderRadius=getBorderRadiusData(element),borderPoints=calculateCurvePoints(bounds,borderRadius,borders),borderData={clip:getBorderClip(element,borderPoints,borders,borderRadius,bounds),borders:[]};for(borderSide=0;4>borderSide;borderSide++)if(borders[borderSide].width>0){switch(bx=x,by=y,bw=width,bh=height-borders[2].width,borderSide){case 0:bh=borders[0].width,borderArgs=drawSide({c1:[bx,by],c2:[bx+bw,by],c3:[bx+bw-borders[1].width,by+bh],c4:[bx+borders[3].width,by+bh]},borderRadius[0],borderRadius[1],borderPoints.topLeftOuter,borderPoints.topLeftInner,borderPoints.topRightOuter,borderPoints.topRightInner);break;case 1:bx=x+width-borders[1].width,bw=borders[1].width,borderArgs=drawSide({c1:[bx+bw,by],c2:[bx+bw,by+bh+borders[2].width],c3:[bx,by+bh],c4:[bx,by+borders[0].width]},borderRadius[1],borderRadius[2],borderPoints.topRightOuter,borderPoints.topRightInner,borderPoints.bottomRightOuter,borderPoints.bottomRightInner);break;case 2:by=by+height-borders[2].width,bh=borders[2].width,borderArgs=drawSide({c1:[bx+bw,by+bh],c2:[bx,by+bh],c3:[bx+borders[3].width,by],c4:[bx+bw-borders[3].width,by]},borderRadius[2],borderRadius[3],borderPoints.bottomRightOuter,borderPoints.bottomRightInner,borderPoints.bottomLeftOuter,borderPoints.bottomLeftInner);break;case 3:bw=borders[3].width,borderArgs=drawSide({c1:[bx,by+bh+borders[2].width],c2:[bx,by],c3:[bx+bw,by+borders[0].width],c4:[bx+bw,by+bh]},borderRadius[3],borderRadius[0],borderPoints.bottomLeftOuter,borderPoints.bottomLeftInner,borderPoints.topLeftOuter,borderPoints.topLeftInner)}borderData.borders.push({args:borderArgs,color:borders[borderSide].color})}return borderData}function createShape(ctx,args){var shape=ctx.drawShape();return args.forEach(function(border,index){shape[0===index?"moveTo":border[0]+"To"].apply(null,border.slice(1))}),shape}function renderBorders(ctx,borderArgs,color){"transparent"!==color&&(ctx.setVariable("fillStyle",color),createShape(ctx,borderArgs),ctx.fill(),numDraws+=1)}function renderFormValue(el,bounds,stack){var textValue,textNode,valueWrap=doc.createElement("valuewrap"),cssPropertyArray=["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"];cssPropertyArray.forEach(function(property){try{valueWrap.style[property]=getCSS(el,property)}catch(e){Util.log("html2canvas: Parse: Exception caught in renderFormValue: "+e.message)}}),valueWrap.style.borderColor="black",valueWrap.style.borderStyle="solid",valueWrap.style.display="block",valueWrap.style.position="absolute",(/^(submit|reset|button|text|password)$/.test(el.type)||"SELECT"===el.nodeName)&&(valueWrap.style.lineHeight=getCSS(el,"height")),valueWrap.style.top=bounds.top+"px",valueWrap.style.left=bounds.left+"px",textValue="SELECT"===el.nodeName?(el.options[el.selectedIndex]||0).text:el.value,textValue||(textValue=el.placeholder),textNode=doc.createTextNode(textValue),valueWrap.appendChild(textNode),body.appendChild(valueWrap),renderText(el,textNode,stack),body.removeChild(valueWrap)}function drawImage(ctx){ctx.drawImage.apply(ctx,Array.prototype.slice.call(arguments,1)),numDraws+=1}function getPseudoElement(el,which){var elStyle=window.getComputedStyle(el,which);if(elStyle&&elStyle.content&&"none"!==elStyle.content&&"-moz-alt-content"!==elStyle.content&&"none"!==elStyle.display){var content=elStyle.content+"",first=content.substr(0,1);first===content.substr(content.length-1)&&first.match(/'|"/)&&(content=content.substr(1,content.length-2));var isImage="url"===content.substr(0,3),elps=document.createElement(isImage?"img":"span");return elps.className=pseudoHide+"-before "+pseudoHide+"-after",Object.keys(elStyle).filter(indexedProperty).forEach(function(prop){try{elps.style[prop]=elStyle[prop]}catch(e){Util.log(["Tried to assign readonly property ",prop,"Error:",e])}}),isImage?elps.src=Util.parseBackgroundImage(content)[0].args[0]:elps.innerHTML=content,elps}}function indexedProperty(property){return isNaN(window.parseInt(property,10))}function injectPseudoElements(el,stack){var before=getPseudoElement(el,":before"),after=getPseudoElement(el,":after");(before||after)&&(before&&(el.className+=" "+pseudoHide+"-before",el.parentNode.insertBefore(before,el),parseElement(before,stack,!0),el.parentNode.removeChild(before),el.className=el.className.replace(pseudoHide+"-before","").trim()),after&&(el.className+=" "+pseudoHide+"-after",el.appendChild(after),parseElement(after,stack,!0),el.removeChild(after),el.className=el.className.replace(pseudoHide+"-after","").trim()))}function renderBackgroundRepeat(ctx,image,backgroundPosition,bounds){var offsetX=Math.round(bounds.left+backgroundPosition.left),offsetY=Math.round(bounds.top+backgroundPosition.top);ctx.createPattern(image),ctx.translate(offsetX,offsetY),ctx.fill(),ctx.translate(-offsetX,-offsetY)}function backgroundRepeatShape(ctx,image,backgroundPosition,bounds,left,top,width,height){var args=[];args.push(["line",Math.round(left),Math.round(top)]),args.push(["line",Math.round(left+width),Math.round(top)]),args.push(["line",Math.round(left+width),Math.round(height+top)]),args.push(["line",Math.round(left),Math.round(height+top)]),createShape(ctx,args),ctx.save(),ctx.clip(),renderBackgroundRepeat(ctx,image,backgroundPosition,bounds),ctx.restore()}function renderBackgroundColor(ctx,backgroundBounds,bgcolor){renderRect(ctx,backgroundBounds.left,backgroundBounds.top,backgroundBounds.width,backgroundBounds.height,bgcolor)}function renderBackgroundRepeating(el,bounds,ctx,image,imageIndex){var backgroundSize=Util.BackgroundSize(el,bounds,image,imageIndex),backgroundPosition=Util.BackgroundPosition(el,bounds,image,imageIndex,backgroundSize),backgroundRepeat=getCSS(el,"backgroundRepeat").split(",").map(Util.trimText);switch(image=resizeImage(image,backgroundSize),backgroundRepeat=backgroundRepeat[imageIndex]||backgroundRepeat[0]){case"repeat-x":backgroundRepeatShape(ctx,image,backgroundPosition,bounds,bounds.left,bounds.top+backgroundPosition.top,99999,image.height);break;case"repeat-y":backgroundRepeatShape(ctx,image,backgroundPosition,bounds,bounds.left+backgroundPosition.left,bounds.top,image.width,99999);break;case"no-repeat":backgroundRepeatShape(ctx,image,backgroundPosition,bounds,bounds.left+backgroundPosition.left,bounds.top+backgroundPosition.top,image.width,image.height);break;default:renderBackgroundRepeat(ctx,image,backgroundPosition,{top:bounds.top,left:bounds.left,width:image.width,height:image.height})}}function renderBackgroundImage(element,bounds,ctx){for(var image,backgroundImage=getCSS(element,"backgroundImage"),backgroundImages=Util.parseBackgroundImage(backgroundImage),imageIndex=backgroundImages.length;imageIndex--;)if(backgroundImage=backgroundImages[imageIndex],backgroundImage.args&&0!==backgroundImage.args.length){var key="url"===backgroundImage.method?backgroundImage.args[0]:backgroundImage.value;image=loadImage(key),image?renderBackgroundRepeating(element,bounds,ctx,image,imageIndex):Util.log("html2canvas: Error loading background:",backgroundImage)}}function resizeImage(image,bounds){if(image.width===bounds.width&&image.height===bounds.height)return image;var ctx,canvas=doc.createElement("canvas");return canvas.width=bounds.width,canvas.height=bounds.height,ctx=canvas.getContext("2d"),drawImage(ctx,image,0,0,image.width,image.height,0,0,bounds.width,bounds.height),canvas}function setOpacity(ctx,element,parentStack){return ctx.setVariable("globalAlpha",getCSS(element,"opacity")*(parentStack?parentStack.opacity:1))}function removePx(str){return str.replace("px","")}function getTransform(element){var transform=getCSS(element,"transform")||getCSS(element,"-webkit-transform")||getCSS(element,"-moz-transform")||getCSS(element,"-ms-transform")||getCSS(element,"-o-transform"),transformOrigin=getCSS(element,"transform-origin")||getCSS(element,"-webkit-transform-origin")||getCSS(element,"-moz-transform-origin")||getCSS(element,"-ms-transform-origin")||getCSS(element,"-o-transform-origin")||"0px 0px";transformOrigin=transformOrigin.split(" ").map(removePx).map(Util.asFloat);var matrix;if(transform&&"none"!==transform){var match=transform.match(transformRegExp);if(match)switch(match[1]){case"matrix":matrix=match[2].split(",").map(Util.trimText).map(Util.asFloat)}}return{origin:transformOrigin,matrix:matrix}}function createStack(element,parentStack,bounds,transform){var ctx=h2cRenderContext(parentStack?bounds.width:documentWidth(),parentStack?bounds.height:documentHeight()),stack={ctx:ctx,opacity:setOpacity(ctx,element,parentStack),cssPosition:getCSS(element,"position"),borders:getBorderData(element),transform:transform,clip:parentStack&&parentStack.clip?Util.Extend({},parentStack.clip):null};return setZ(element,stack,parentStack),options.useOverflow===!0&&/(hidden|scroll|auto)/.test(getCSS(element,"overflow"))===!0&&/(BODY)/i.test(element.nodeName)===!1&&(stack.clip=stack.clip?clipBounds(stack.clip,bounds):bounds),stack}function getBackgroundBounds(borders,bounds,clip){var backgroundBounds={left:bounds.left+borders[3].width,top:bounds.top+borders[0].width,width:bounds.width-(borders[1].width+borders[3].width),height:bounds.height-(borders[0].width+borders[2].width)};return clip&&(backgroundBounds=clipBounds(backgroundBounds,clip)),backgroundBounds}function getBounds(element,transform){var bounds=transform.matrix?Util.OffsetBounds(element):Util.Bounds(element);return transform.origin[0]+=bounds.left,transform.origin[1]+=bounds.top,bounds}function renderElement(element,parentStack,pseudoElement,ignoreBackground){var image,transform=getTransform(element,parentStack),bounds=getBounds(element,transform),stack=createStack(element,parentStack,bounds,transform),borders=stack.borders,ctx=stack.ctx,backgroundBounds=getBackgroundBounds(borders,bounds,stack.clip),borderData=parseBorders(element,bounds,borders),backgroundColor=ignoreElementsRegExp.test(element.nodeName)?"#efefef":getCSS(element,"backgroundColor");switch(createShape(ctx,borderData.clip),ctx.save(),ctx.clip(),backgroundBounds.height>0&&backgroundBounds.width>0&&!ignoreBackground?(renderBackgroundColor(ctx,bounds,backgroundColor),renderBackgroundImage(element,backgroundBounds,ctx)):ignoreBackground&&(stack.backgroundColor=backgroundColor),ctx.restore(),borderData.borders.forEach(function(border){renderBorders(ctx,border.args,border.color)}),pseudoElement||injectPseudoElements(element,stack),element.nodeName){case"IMG":(image=loadImage(element.getAttribute("src")))?renderImage(ctx,element,image,bounds,borders):Util.log("html2canvas: Error loading <img>:"+element.getAttribute("src"));break;case"INPUT":/^(text|url|email|submit|button|reset)$/.test(element.type)&&(element.value||element.placeholder||"").length>0&&renderFormValue(element,bounds,stack);break;case"TEXTAREA":(element.value||element.placeholder||"").length>0&&renderFormValue(element,bounds,stack);break;case"SELECT":(element.options||element.placeholder||"").length>0&&renderFormValue(element,bounds,stack);break;case"LI":renderListItem(element,stack,backgroundBounds);break;case"CANVAS":renderImage(ctx,element,element,bounds,borders)}return stack}function isElementVisible(element){return"none"!==getCSS(element,"display")&&"hidden"!==getCSS(element,"visibility")&&!element.hasAttribute("data-html2canvas-ignore")}function parseElement(element,stack,pseudoElement){isElementVisible(element)&&(stack=renderElement(element,stack,pseudoElement,!1)||stack,ignoreElementsRegExp.test(element.nodeName)||parseChildren(element,stack,pseudoElement))}function parseChildren(element,stack,pseudoElement){Util.Children(element).forEach(function(node){node.nodeType===node.ELEMENT_NODE?parseElement(node,stack,pseudoElement):node.nodeType===node.TEXT_NODE&&renderText(element,node,stack)
})}function init(){var background=getCSS(document.documentElement,"backgroundColor"),transparentBackground=Util.isTransparent(background)&&element===document.body,stack=renderElement(element,null,!1,transparentBackground);return parseChildren(element,stack),transparentBackground&&(background=stack.backgroundColor),body.removeChild(hidePseudoElements),{backgroundColor:background,stack:stack}}window.scroll(0,0);var element=options.elements===undefined?document.body:options.elements[0],numDraws=0,doc=element.ownerDocument,Util=_html2canvas.Util,support=Util.Support(options,doc),ignoreElementsRegExp=new RegExp("("+options.ignoreElements+")"),body=doc.body,getCSS=Util.getCSS,pseudoHide="___html2canvas___pseudoelement",hidePseudoElements=doc.createElement("style");hidePseudoElements.innerHTML="."+pseudoHide+'-before:before { content: "" !important; display: none !important; }.'+pseudoHide+'-after:after { content: "" !important; display: none !important; }',body.appendChild(hidePseudoElements),images=images||{};var getCurvePoints=function(kappa){return function(x,y,r1,r2){var ox=r1*kappa,oy=r2*kappa,xm=x+r1,ym=y+r2;return{topLeft:bezierCurve({x:x,y:ym},{x:x,y:ym-oy},{x:xm-ox,y:y},{x:xm,y:y}),topRight:bezierCurve({x:x,y:y},{x:x+ox,y:y},{x:xm,y:ym-oy},{x:xm,y:ym}),bottomRight:bezierCurve({x:xm,y:y},{x:xm,y:y+oy},{x:x+ox,y:ym},{x:x,y:ym}),bottomLeft:bezierCurve({x:xm,y:ym},{x:xm-ox,y:ym},{x:x,y:y+oy},{x:x,y:y})}}}(4*((Math.sqrt(2)-1)/3)),transformRegExp=/(matrix)\((.+)\)/;return init()},_html2canvas.Preload=function(options){function isSameOrigin(url){link.href=url,link.href=link.href;var origin=link.protocol+link.host;return origin===pageOrigin}function start(){Util.log("html2canvas: start: images: "+images.numLoaded+" / "+images.numTotal+" (failed: "+images.numFailed+")"),!images.firstRun&&images.numLoaded>=images.numTotal&&(Util.log("Finished loading images: # "+images.numTotal+" (failed: "+images.numFailed+")"),"function"==typeof options.complete&&options.complete(images))}function proxyGetImage(url,img,imageObj){var callback_name,script,scriptUrl=options.proxy;link.href=url,url=link.href,callback_name="html2canvas_"+count++,imageObj.callbackname=callback_name,scriptUrl+=scriptUrl.indexOf("?")>-1?"&":"?",scriptUrl+="url="+encodeURIComponent(url)+"&callback="+callback_name,script=doc.createElement("script"),window[callback_name]=function(a){"error:"===a.substring(0,6)?(imageObj.succeeded=!1,images.numLoaded++,images.numFailed++,start()):(setImageLoadHandlers(img,imageObj),img.src=a),window[callback_name]=undefined;try{delete window[callback_name]}catch(ex){}script.parentNode.removeChild(script),script=null,delete imageObj.script,delete imageObj.callbackname},script.setAttribute("type","text/javascript"),script.setAttribute("src",scriptUrl),imageObj.script=script,window.document.body.appendChild(script)}function loadPseudoElement(element,type){var style=window.getComputedStyle(element,type),content=style.content;"url"===content.substr(0,3)&&methods.loadImage(_html2canvas.Util.parseBackgroundImage(content)[0].args[0]),loadBackgroundImages(style.backgroundImage,element)}function loadPseudoElementImages(element){loadPseudoElement(element,":before"),loadPseudoElement(element,":after")}function loadGradientImage(backgroundImage,bounds){var img=_html2canvas.Generate.Gradient(backgroundImage,bounds);img!==undefined&&(images[backgroundImage]={img:img,succeeded:!0},images.numTotal++,images.numLoaded++,start())}function invalidBackgrounds(background_image){return background_image&&background_image.method&&background_image.args&&background_image.args.length>0}function loadBackgroundImages(background_image,el){var bounds;_html2canvas.Util.parseBackgroundImage(background_image).filter(invalidBackgrounds).forEach(function(background_image){"url"===background_image.method?methods.loadImage(background_image.args[0]):background_image.method.match(/\-?gradient$/)&&(bounds===undefined&&(bounds=_html2canvas.Util.Bounds(el)),loadGradientImage(background_image.value,bounds))})}function getImages(el){var elNodeType=!1;try{Util.Children(el).forEach(getImages)}catch(e){}try{elNodeType=el.nodeType}catch(ex){elNodeType=!1,Util.log("html2canvas: failed to access some element's nodeType - Exception: "+ex.message)}if(1===elNodeType||elNodeType===undefined){loadPseudoElementImages(el);try{loadBackgroundImages(Util.getCSS(el,"backgroundImage"),el)}catch(e){Util.log("html2canvas: failed to get background-image - Exception: "+e.message)}loadBackgroundImages(el)}}function setImageLoadHandlers(img,imageObj){img.onload=function(){imageObj.timer!==undefined&&window.clearTimeout(imageObj.timer),images.numLoaded++,imageObj.succeeded=!0,img.onerror=img.onload=null,start()},img.onerror=function(){if("anonymous"===img.crossOrigin&&(window.clearTimeout(imageObj.timer),options.proxy)){var src=img.src;return img=new Image,imageObj.img=img,img.src=src,void proxyGetImage(img.src,img,imageObj)}images.numLoaded++,images.numFailed++,imageObj.succeeded=!1,img.onerror=img.onload=null,start()}}var pageOrigin,methods,i,timeoutTimer,images={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},Util=_html2canvas.Util,count=0,element=options.elements[0]||document.body,doc=element.ownerDocument,domImages=element.getElementsByTagName("img"),imgLen=domImages.length,link=doc.createElement("a"),supportCORS=function(img){return img.crossOrigin!==undefined}(new Image);for(link.href=window.location.href,pageOrigin=link.protocol+link.host,methods={loadImage:function(src){var img,imageObj;src&&images[src]===undefined&&(img=new Image,src.match(/data:image\/.*;base64,/i)?(img.src=src.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),imageObj=images[src]={img:img},images.numTotal++,setImageLoadHandlers(img,imageObj)):isSameOrigin(src)||options.allowTaint===!0?(imageObj=images[src]={img:img},images.numTotal++,setImageLoadHandlers(img,imageObj),img.src=src):supportCORS&&!options.allowTaint&&options.useCORS?(img.crossOrigin="anonymous",imageObj=images[src]={img:img},images.numTotal++,setImageLoadHandlers(img,imageObj),img.src=src):options.proxy&&(imageObj=images[src]={img:img},images.numTotal++,proxyGetImage(src,img,imageObj)))},cleanupDOM:function(cause){var img,src;if(!images.cleanupDone){Util.log(cause&&"string"==typeof cause?"html2canvas: Cleanup because: "+cause:"html2canvas: Cleanup after timeout: "+options.timeout+" ms.");for(src in images)if(images.hasOwnProperty(src)&&(img=images[src],"object"==typeof img&&img.callbackname&&img.succeeded===undefined)){window[img.callbackname]=undefined;try{delete window[img.callbackname]}catch(ex){}img.script&&img.script.parentNode&&(img.script.setAttribute("src","about:blank"),img.script.parentNode.removeChild(img.script)),images.numLoaded++,images.numFailed++,Util.log("html2canvas: Cleaned up failed img: '"+src+"' Steps: "+images.numLoaded+" / "+images.numTotal)}window.stop!==undefined?window.stop():document.execCommand!==undefined&&document.execCommand("Stop",!1),document.close!==undefined&&document.close(),images.cleanupDone=!0,cause&&"string"==typeof cause||start()}},renderingDone:function(){timeoutTimer&&window.clearTimeout(timeoutTimer)}},options.timeout>0&&(timeoutTimer=window.setTimeout(methods.cleanupDOM,options.timeout)),Util.log("html2canvas: Preload starts: finding background-images"),images.firstRun=!0,getImages(element),Util.log("html2canvas: Preload: Finding images"),i=0;imgLen>i;i+=1)methods.loadImage(domImages[i].getAttribute("src"));return images.firstRun=!1,Util.log("html2canvas: Preload: Done."),images.numTotal===images.numLoaded&&start(),methods},_html2canvas.Renderer=function(parseQueue,options){function createRenderQueue(parseQueue){function sortZ(context){Object.keys(context).sort().forEach(function(zi){var nonPositioned=[],floated=[],positioned=[],list=[];context[zi].forEach(function(v){v.node.zIndex.isPositioned||v.node.zIndex.opacity<1?positioned.push(v):v.node.zIndex.isFloated?floated.push(v):nonPositioned.push(v)}),function walk(arr){arr.forEach(function(v){list.push(v),v.children&&walk(v.children)})}(nonPositioned.concat(floated,positioned)),list.forEach(function(v){v.context?sortZ(v.context):queue.push(v.node)})})}var rootContext,queue=[];return rootContext=function(rootNode){function insert(context,node,specialParent){var zi="auto"===node.zIndex.zindex?0:Number(node.zIndex.zindex),contextForChildren=context,isPositioned=node.zIndex.isPositioned,isFloated=node.zIndex.isFloated,stub={node:node},childrenDest=specialParent;node.zIndex.ownStacking?(contextForChildren=stub.context={"!":[{node:node,children:[]}]},childrenDest=undefined):(isPositioned||isFloated)&&(childrenDest=stub.children=[]),0===zi&&specialParent?specialParent.push(stub):(context[zi]||(context[zi]=[]),context[zi].push(stub)),node.zIndex.children.forEach(function(childNode){insert(contextForChildren,childNode,childrenDest)})}var rootContext={};return insert(rootContext,rootNode),rootContext}(parseQueue),sortZ(rootContext),queue}function getRenderer(rendererName){var renderer;if("string"==typeof options.renderer&&_html2canvas.Renderer[rendererName]!==undefined)renderer=_html2canvas.Renderer[rendererName](options);else{if("function"!=typeof rendererName)throw new Error("Unknown renderer");renderer=rendererName(options)}if("function"!=typeof renderer)throw new Error("Invalid renderer defined");return renderer}return getRenderer(options.renderer)(parseQueue,options,document,createRenderQueue(parseQueue.stack),_html2canvas)},_html2canvas.Util.Support=function(options,doc){function supportSVGRendering(){var img=new Image,canvas=doc.createElement("canvas"),ctx=canvas.getContext===undefined?!1:canvas.getContext("2d");if(ctx===!1)return!1;canvas.width=canvas.height=10,img.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{ctx.drawImage(img,0,0),canvas.toDataURL()}catch(e){return!1}return _html2canvas.Util.log("html2canvas: Parse: SVG powered rendering available"),!0}function supportRangeBounds(){var r,testElement,rangeBounds,rangeHeight,support=!1;return doc.createRange&&(r=doc.createRange(),r.getBoundingClientRect&&(testElement=doc.createElement("boundtest"),testElement.style.height="123px",testElement.style.display="block",doc.body.appendChild(testElement),r.selectNode(testElement),rangeBounds=r.getBoundingClientRect(),rangeHeight=rangeBounds.height,123===rangeHeight&&(support=!0),doc.body.removeChild(testElement))),support}return{rangeBounds:supportRangeBounds(),svgRendering:options.svgRendering&&supportSVGRendering()}},window.html2canvas=function(elements,opts){elements=elements.length?elements:[elements];var queue,canvas,options={logging:!1,elements:elements,background:"#fff",proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:"Canvas"};return options=_html2canvas.Util.Extend(opts,options),_html2canvas.logging=options.logging,options.complete=function(images){("function"!=typeof options.onpreloaded||options.onpreloaded(images)!==!1)&&(queue=_html2canvas.Parse(images,options),("function"!=typeof options.onparsed||options.onparsed(queue)!==!1)&&(canvas=_html2canvas.Renderer(queue,options),"function"==typeof options.onrendered&&options.onrendered(canvas)))},window.setTimeout(function(){_html2canvas.Preload(options)},0),{render:function(queue,opts){return _html2canvas.Renderer(queue,_html2canvas.Util.Extend(opts,options))},parse:function(images,opts){return _html2canvas.Parse(images,_html2canvas.Util.Extend(opts,options))},preload:function(opts){return _html2canvas.Preload(_html2canvas.Util.Extend(opts,options))},log:_html2canvas.Util.log}},window.html2canvas.log=_html2canvas.Util.log,window.html2canvas.Renderer={Canvas:undefined},_html2canvas.Renderer.Canvas=function(options){function createShape(ctx,args){ctx.beginPath(),args.forEach(function(arg){ctx[arg.name].apply(ctx,arg.arguments)}),ctx.closePath()}function safeImage(item){if(-1===safeImages.indexOf(item.arguments[0].src)){testctx.drawImage(item.arguments[0],0,0);try{testctx.getImageData(0,0,1,1)}catch(e){return testCanvas=doc.createElement("canvas"),testctx=testCanvas.getContext("2d"),!1}safeImages.push(item.arguments[0].src)}return!0}function renderItem(ctx,item){switch(item.type){case"variable":ctx[item.name]=item.arguments;break;case"function":switch(item.name){case"createPattern":if(item.arguments[0].width>0&&item.arguments[0].height>0)try{ctx.fillStyle=ctx.createPattern(item.arguments[0],"repeat")}catch(e){Util.log("html2canvas: Renderer: Error creating pattern",e.message)}break;case"drawShape":createShape(ctx,item.arguments);break;case"drawImage":item.arguments[8]>0&&item.arguments[7]>0&&(!options.taintTest||options.taintTest&&safeImage(item))&&ctx.drawImage.apply(ctx,item.arguments);break;default:ctx[item.name].apply(ctx,item.arguments)}}}options=options||{};var doc=document,safeImages=[],testCanvas=document.createElement("canvas"),testctx=testCanvas.getContext("2d"),Util=_html2canvas.Util,canvas=options.canvas||doc.createElement("canvas");return function(parsedData,options,document,queue,_html2canvas){var newCanvas,bounds,fstyle,ctx=canvas.getContext("2d"),zStack=parsedData.stack;return canvas.width=canvas.style.width=options.width||zStack.ctx.width,canvas.height=canvas.style.height=options.height||zStack.ctx.height,fstyle=ctx.fillStyle,ctx.fillStyle=Util.isTransparent(zStack.backgroundColor)&&options.background!==undefined?options.background:parsedData.backgroundColor,ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle=fstyle,queue.forEach(function(storageContext){ctx.textBaseline="bottom",ctx.save(),storageContext.transform.matrix&&(ctx.translate(storageContext.transform.origin[0],storageContext.transform.origin[1]),ctx.transform.apply(ctx,storageContext.transform.matrix),ctx.translate(-storageContext.transform.origin[0],-storageContext.transform.origin[1])),storageContext.clip&&(ctx.beginPath(),ctx.rect(storageContext.clip.left,storageContext.clip.top,storageContext.clip.width,storageContext.clip.height),ctx.clip()),storageContext.ctx.storage&&storageContext.ctx.storage.forEach(function(item){renderItem(ctx,item)}),ctx.restore()}),Util.log("html2canvas: Renderer: Canvas renderer done - returning canvas obj"),1===options.elements.length&&"object"==typeof options.elements[0]&&"BODY"!==options.elements[0].nodeName?(bounds=_html2canvas.Util.Bounds(options.elements[0]),newCanvas=document.createElement("canvas"),newCanvas.width=Math.ceil(bounds.width),newCanvas.height=Math.ceil(bounds.height),ctx=newCanvas.getContext("2d"),ctx.drawImage(canvas,bounds.left,bounds.top,bounds.width,bounds.height,0,0,bounds.width,bounds.height),canvas=null,newCanvas):canvas}}}(window,document);var Filter=function(){function Filter(element){this._element=$(element),this._optionsContainer=this._element.find(this.constructor.optionsContainerSelector)}return Filter.selector=".filter",Filter.optionsContainerSelector="> div",Filter.hideOptionsClass="hide-options",Filter.enhance=function(){var klass=this;return jQuery(klass.selector).each(function(){return new klass(this).enhance()})},Filter.prototype.enhance=function(){this._buildUI(),this._bindEvents()},Filter.prototype._buildUI=function(){this._summaryElement=$("<label></label>").addClass("summary").attr("data-role","summary").prependTo(this._optionsContainer),this._clearSelectionButton=$("<button></button>").text("Clear").attr("type","button").insertAfter(this._summaryElement),this._optionsContainer.addClass(this.constructor.hideOptionsClass),this._updateSummary()},Filter.prototype._bindEvents=function(){var self=this;this._summaryElement.click(function(){self._toggleOptions()}),this._clearSelectionButton.click(function(){self._clearSelection()}),this._checkboxes().change(function(){self._updateSummary()}),$("body").click(function(e){var inFilter=$(e.target).closest(self.constructor.selector).length>0;inFilter||self._allOptionsContainers().addClass(self.constructor.hideOptionsClass)})},Filter.prototype._toggleOptions=function(){this._allOptionsContainers().not(this._optionsContainer).addClass(this.constructor.hideOptionsClass),this._optionsContainer.toggleClass(this.constructor.hideOptionsClass)},Filter.prototype._updateSummary=function(){var summary="All",checked=this._checkboxes().filter(":checked");checked.length>0&&(summary=this._labelsFor(checked).join(", ")),this._summaryElement.text(summary)},Filter.prototype._clearSelection=function(){this._checkboxes().each(function(){$(this).prop("checked",!1)}),this._updateSummary()},Filter.prototype._checkboxes=function(){return this._element.find(":checkbox")},Filter.prototype._labelsFor=function(inputs){return inputs.map(function(){var id=$(this).attr("id");return $("label[for='"+id+"']").text()}).get()},Filter.prototype._allOptionsContainers=function(){return $(this.constructor.selector+" "+this.constructor.optionsContainerSelector)},Filter}();jQuery(function(){Filter.enhance()}),function($){var plugin={},defaults={mode:"horizontal",slideSelector:"",infiniteLoop:!0,hideControlOnEnd:!1,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:!1,captions:!1,ticker:!1,tickerHover:!1,adaptiveHeight:!1,adaptiveHeightSpeed:500,video:!1,useCSS:!0,preloadImages:"visible",responsive:!0,slideZIndex:50,wrapperClass:"bx-wrapper",touchEnabled:!0,swipeThreshold:50,oneToOneTouch:!0,preventDefaultSwipeX:!0,preventDefaultSwipeY:!1,pager:!0,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:!0,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:!1,startText:"Start",stopText:"Stop",autoControlsCombine:!1,autoControlsSelector:null,auto:!1,pause:4e3,autoStart:!0,autoDirection:"next",autoHover:!1,autoDelay:0,autoSlideForOnePage:!1,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,onSliderLoad:function(){},onSlideBefore:function(){},onSlideAfter:function(){},onSlideNext:function(){},onSlidePrev:function(){},onSliderResize:function(){}};$.fn.bxSlider=function(options){if(0===this.length)return this;if(this.length>1)return this.each(function(){$(this).bxSlider(options)}),this;var slider={},el=this;plugin.el=this;var windowWidth=$(window).width(),windowHeight=$(window).height(),init=function(){slider.settings=$.extend({},defaults,options),slider.settings.slideWidth=parseInt(slider.settings.slideWidth),slider.children=el.children(slider.settings.slideSelector),slider.children.length<slider.settings.minSlides&&(slider.settings.minSlides=slider.children.length),slider.children.length<slider.settings.maxSlides&&(slider.settings.maxSlides=slider.children.length),slider.settings.randomStart&&(slider.settings.startSlide=Math.floor(Math.random()*slider.children.length)),slider.active={index:slider.settings.startSlide},slider.carousel=slider.settings.minSlides>1||slider.settings.maxSlides>1,slider.carousel&&(slider.settings.preloadImages="all"),slider.minThreshold=slider.settings.minSlides*slider.settings.slideWidth+(slider.settings.minSlides-1)*slider.settings.slideMargin,slider.maxThreshold=slider.settings.maxSlides*slider.settings.slideWidth+(slider.settings.maxSlides-1)*slider.settings.slideMargin,slider.working=!1,slider.controls={},slider.interval=null,slider.animProp="vertical"==slider.settings.mode?"top":"left",slider.usingCSS=slider.settings.useCSS&&"fade"!=slider.settings.mode&&function(){var div=document.createElement("div"),props=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in props)if(void 0!==div.style[props[i]])return slider.cssPrefix=props[i].replace("Perspective","").toLowerCase(),slider.animProp="-"+slider.cssPrefix+"-transform",!0;return!1}(),"vertical"==slider.settings.mode&&(slider.settings.maxSlides=slider.settings.minSlides),el.data("origStyle",el.attr("style")),el.children(slider.settings.slideSelector).each(function(){$(this).data("origStyle",$(this).attr("style"))}),setup()},setup=function(){el.wrap('<div class="'+slider.settings.wrapperClass+'"><div class="bx-viewport"></div></div>'),slider.viewport=el.parent(),slider.loader=$('<div class="bx-loading" />'),slider.viewport.prepend(slider.loader),el.css({width:"horizontal"==slider.settings.mode?100*slider.children.length+215+"%":"auto",position:"relative"}),slider.usingCSS&&slider.settings.easing?el.css("-"+slider.cssPrefix+"-transition-timing-function",slider.settings.easing):slider.settings.easing||(slider.settings.easing="swing");getNumberSlidesShowing();slider.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),slider.viewport.parent().css({maxWidth:getViewportMaxWidth()}),slider.settings.pager||slider.viewport.parent().css({margin:"0 auto 0px"}),slider.children.css({"float":"horizontal"==slider.settings.mode?"left":"none",listStyle:"none",position:"relative"}),slider.children.css("width",getSlideWidth()),"horizontal"==slider.settings.mode&&slider.settings.slideMargin>0&&slider.children.css("marginRight",slider.settings.slideMargin),"vertical"==slider.settings.mode&&slider.settings.slideMargin>0&&slider.children.css("marginBottom",slider.settings.slideMargin),"fade"==slider.settings.mode&&(slider.children.css({position:"absolute",zIndex:0,display:"none"}),slider.children.eq(slider.settings.startSlide).css({zIndex:slider.settings.slideZIndex,display:"block"})),slider.controls.el=$('<div class="bx-controls" />'),slider.settings.captions&&appendCaptions(),slider.active.last=slider.settings.startSlide==getPagerQty()-1,slider.settings.video&&el.fitVids();var preloadSelector=slider.children.eq(slider.settings.startSlide);"all"==slider.settings.preloadImages&&(preloadSelector=slider.children),slider.settings.ticker?slider.settings.pager=!1:(slider.settings.pager&&appendPager(),slider.settings.controls&&appendControls(),slider.settings.auto&&slider.settings.autoControls&&appendControlsAuto(),(slider.settings.controls||slider.settings.autoControls||slider.settings.pager)&&slider.viewport.after(slider.controls.el)),loadElements(preloadSelector,start)},loadElements=function(selector,callback){var total=selector.find("img, iframe").length;if(0===total)return void callback();var count=0;selector.find("img, iframe").each(function(){$(this).one("load",function(){++count==total&&callback()}).each(function(){this.complete&&$(this).load()})})},start=function(){if(slider.settings.infiniteLoop&&"fade"!=slider.settings.mode&&!slider.settings.ticker){var slice="vertical"==slider.settings.mode?slider.settings.minSlides:slider.settings.maxSlides,sliceAppend=slider.children.slice(0,slice).clone().addClass("bx-clone"),slicePrepend=slider.children.slice(-slice).clone().addClass("bx-clone");el.append(sliceAppend).prepend(slicePrepend)}slider.loader.remove(),setSlidePosition(),"vertical"==slider.settings.mode&&(slider.settings.adaptiveHeight=!0),slider.viewport.height(getViewportHeight()),el.redrawSlider(),slider.settings.onSliderLoad(slider.active.index),slider.initialized=!0,slider.settings.responsive&&$(window).bind("resize",resizeWindow),slider.settings.auto&&slider.settings.autoStart&&(getPagerQty()>1||slider.settings.autoSlideForOnePage)&&initAuto(),slider.settings.ticker&&initTicker(),slider.settings.pager&&updatePagerActive(slider.settings.startSlide),slider.settings.controls&&updateDirectionControls(),slider.settings.touchEnabled&&!slider.settings.ticker&&initTouch()},getViewportHeight=function(){var height=0,children=$();if("vertical"==slider.settings.mode||slider.settings.adaptiveHeight)if(slider.carousel){var currentIndex=1==slider.settings.moveSlides?slider.active.index:slider.active.index*getMoveBy();for(children=slider.children.eq(currentIndex),i=1;i<=slider.settings.maxSlides-1;i++)children=children.add(currentIndex+i>=slider.children.length?slider.children.eq(i-1):slider.children.eq(currentIndex+i))}else children=slider.children.eq(slider.active.index);else children=slider.children;return"vertical"==slider.settings.mode?(children.each(function(){height+=$(this).outerHeight()}),slider.settings.slideMargin>0&&(height+=slider.settings.slideMargin*(slider.settings.minSlides-1))):height=Math.max.apply(Math,children.map(function(){return $(this).outerHeight(!1)}).get()),"border-box"==slider.viewport.css("box-sizing")?height+=parseFloat(slider.viewport.css("padding-top"))+parseFloat(slider.viewport.css("padding-bottom"))+parseFloat(slider.viewport.css("border-top-width"))+parseFloat(slider.viewport.css("border-bottom-width")):"padding-box"==slider.viewport.css("box-sizing")&&(height+=parseFloat(slider.viewport.css("padding-top"))+parseFloat(slider.viewport.css("padding-bottom"))),height},getViewportMaxWidth=function(){var width="100%";return slider.settings.slideWidth>0&&(width="horizontal"==slider.settings.mode?slider.settings.maxSlides*slider.settings.slideWidth+(slider.settings.maxSlides-1)*slider.settings.slideMargin:slider.settings.slideWidth),width},getSlideWidth=function(){var newElWidth=slider.settings.slideWidth,wrapWidth=slider.viewport.width();return 0===slider.settings.slideWidth||slider.settings.slideWidth>wrapWidth&&!slider.carousel||"vertical"==slider.settings.mode?newElWidth=wrapWidth:slider.settings.maxSlides>1&&"horizontal"==slider.settings.mode&&(wrapWidth>slider.maxThreshold||wrapWidth<slider.minThreshold&&(newElWidth=(wrapWidth-slider.settings.slideMargin*(slider.settings.minSlides-1))/slider.settings.minSlides)),newElWidth},getNumberSlidesShowing=function(){var slidesShowing=1;if("horizontal"==slider.settings.mode&&slider.settings.slideWidth>0)if(slider.viewport.width()<slider.minThreshold)slidesShowing=slider.settings.minSlides;else if(slider.viewport.width()>slider.maxThreshold)slidesShowing=slider.settings.maxSlides;else{var childWidth=slider.children.first().width()+slider.settings.slideMargin;slidesShowing=Math.floor((slider.viewport.width()+slider.settings.slideMargin)/childWidth)}else"vertical"==slider.settings.mode&&(slidesShowing=slider.settings.minSlides);return slidesShowing},getPagerQty=function(){var pagerQty=0;if(slider.settings.moveSlides>0)if(slider.settings.infiniteLoop)pagerQty=Math.ceil(slider.children.length/getMoveBy());else for(var breakPoint=0,counter=0;breakPoint<slider.children.length;)++pagerQty,breakPoint=counter+getNumberSlidesShowing(),counter+=slider.settings.moveSlides<=getNumberSlidesShowing()?slider.settings.moveSlides:getNumberSlidesShowing();else pagerQty=Math.ceil(slider.children.length/getNumberSlidesShowing());return pagerQty},getMoveBy=function(){return slider.settings.moveSlides>0&&slider.settings.moveSlides<=getNumberSlidesShowing()?slider.settings.moveSlides:getNumberSlidesShowing()},setSlidePosition=function(){if(slider.children.length>slider.settings.maxSlides&&slider.active.last&&!slider.settings.infiniteLoop){if("horizontal"==slider.settings.mode){var lastChild=slider.children.last(),position=lastChild.position();setPositionProperty(-(position.left-(slider.viewport.width()-lastChild.outerWidth())),"reset",0)}else if("vertical"==slider.settings.mode){var lastShowingIndex=slider.children.length-slider.settings.minSlides,position=slider.children.eq(lastShowingIndex).position();setPositionProperty(-position.top,"reset",0)}}else{var position=slider.children.eq(slider.active.index*getMoveBy()).position();slider.active.index==getPagerQty()-1&&(slider.active.last=!0),void 0!==position&&("horizontal"==slider.settings.mode?setPositionProperty(-position.left,"reset",0):"vertical"==slider.settings.mode&&setPositionProperty(-position.top,"reset",0))}},setPositionProperty=function(value,type,duration,params){if(slider.usingCSS){var propValue="vertical"==slider.settings.mode?"translate3d(0, "+value+"px, 0)":"translate3d("+value+"px, 0, 0)";el.css("-"+slider.cssPrefix+"-transition-duration",duration/1e3+"s"),"slide"==type?(el.css(slider.animProp,propValue),el.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){el.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),updateAfterSlideTransition()})):"reset"==type?el.css(slider.animProp,propValue):"ticker"==type&&(el.css("-"+slider.cssPrefix+"-transition-timing-function","linear"),el.css(slider.animProp,propValue),el.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){el.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),setPositionProperty(params.resetValue,"reset",0),tickerLoop()}))}else{var animateObj={};animateObj[slider.animProp]=value,"slide"==type?el.animate(animateObj,duration,slider.settings.easing,function(){updateAfterSlideTransition()}):"reset"==type?el.css(slider.animProp,value):"ticker"==type&&el.animate(animateObj,speed,"linear",function(){setPositionProperty(params.resetValue,"reset",0),tickerLoop()})}},populatePager=function(){for(var pagerHtml="",pagerQty=getPagerQty(),i=0;pagerQty>i;i++){var linkContent="";slider.settings.buildPager&&$.isFunction(slider.settings.buildPager)?(linkContent=slider.settings.buildPager(i),slider.pagerEl.addClass("bx-custom-pager")):(linkContent=i+1,slider.pagerEl.addClass("bx-default-pager")),pagerHtml+='<div class="bx-pager-item"><a href="" data-slide-index="'+i+'" class="bx-pager-link">'+linkContent+"</a></div>"}slider.pagerEl.html(pagerHtml)},appendPager=function(){slider.settings.pagerCustom?slider.pagerEl=$(slider.settings.pagerCustom):(slider.pagerEl=$('<div class="bx-pager" />'),slider.settings.pagerSelector?$(slider.settings.pagerSelector).html(slider.pagerEl):slider.controls.el.addClass("bx-has-pager").append(slider.pagerEl),populatePager()),slider.pagerEl.on("click","a",clickPagerBind)},appendControls=function(){slider.controls.next=$('<a class="bx-next" href="">'+slider.settings.nextText+"</a>"),slider.controls.prev=$('<a class="bx-prev" href="">'+slider.settings.prevText+"</a>"),slider.controls.next.bind("click",clickNextBind),slider.controls.prev.bind("click",clickPrevBind),slider.settings.nextSelector&&$(slider.settings.nextSelector).append(slider.controls.next),slider.settings.prevSelector&&$(slider.settings.prevSelector).append(slider.controls.prev),slider.settings.nextSelector||slider.settings.prevSelector||(slider.controls.directionEl=$('<div class="bx-controls-direction" />'),slider.controls.directionEl.append(slider.controls.prev).append(slider.controls.next),slider.controls.el.addClass("bx-has-controls-direction").append(slider.controls.directionEl))},appendControlsAuto=function(){slider.controls.start=$('<div class="bx-controls-auto-item"><a class="bx-start" href="">'+slider.settings.startText+"</a></div>"),slider.controls.stop=$('<div class="bx-controls-auto-item"><a class="bx-stop" href="">'+slider.settings.stopText+"</a></div>"),slider.controls.autoEl=$('<div class="bx-controls-auto" />'),slider.controls.autoEl.on("click",".bx-start",clickStartBind),slider.controls.autoEl.on("click",".bx-stop",clickStopBind),slider.settings.autoControlsCombine?slider.controls.autoEl.append(slider.controls.start):slider.controls.autoEl.append(slider.controls.start).append(slider.controls.stop),slider.settings.autoControlsSelector?$(slider.settings.autoControlsSelector).html(slider.controls.autoEl):slider.controls.el.addClass("bx-has-controls-auto").append(slider.controls.autoEl),updateAutoControls(slider.settings.autoStart?"stop":"start")},appendCaptions=function(){slider.children.each(function(){var title=$(this).find("img:first").attr("title");void 0!==title&&(""+title).length&&$(this).append('<div class="bx-caption"><span>'+title+"</span></div>")})},clickNextBind=function(e){slider.settings.auto&&el.stopAuto(),el.goToNextSlide(),e.preventDefault()},clickPrevBind=function(e){slider.settings.auto&&el.stopAuto(),el.goToPrevSlide(),e.preventDefault()},clickStartBind=function(e){el.startAuto(),e.preventDefault()},clickStopBind=function(e){el.stopAuto(),e.preventDefault()},clickPagerBind=function(e){slider.settings.auto&&el.stopAuto();var pagerLink=$(e.currentTarget);
if(void 0!==pagerLink.attr("data-slide-index")){var pagerIndex=parseInt(pagerLink.attr("data-slide-index"));pagerIndex!=slider.active.index&&el.goToSlide(pagerIndex),e.preventDefault()}},updatePagerActive=function(slideIndex){var len=slider.children.length;return"short"==slider.settings.pagerType?(slider.settings.maxSlides>1&&(len=Math.ceil(slider.children.length/slider.settings.maxSlides)),void slider.pagerEl.html(slideIndex+1+slider.settings.pagerShortSeparator+len)):(slider.pagerEl.find("a").removeClass("active"),void slider.pagerEl.each(function(i,el){$(el).find("a").eq(slideIndex).addClass("active")}))},updateAfterSlideTransition=function(){if(slider.settings.infiniteLoop){var position="";0===slider.active.index?position=slider.children.eq(0).position():slider.active.index==getPagerQty()-1&&slider.carousel?position=slider.children.eq((getPagerQty()-1)*getMoveBy()).position():slider.active.index==slider.children.length-1&&(position=slider.children.eq(slider.children.length-1).position()),position&&("horizontal"==slider.settings.mode?setPositionProperty(-position.left,"reset",0):"vertical"==slider.settings.mode&&setPositionProperty(-position.top,"reset",0))}slider.working=!1,slider.settings.onSlideAfter(slider.children.eq(slider.active.index),slider.oldIndex,slider.active.index)},updateAutoControls=function(state){slider.settings.autoControlsCombine?slider.controls.autoEl.html(slider.controls[state]):(slider.controls.autoEl.find("a").removeClass("active"),slider.controls.autoEl.find("a:not(.bx-"+state+")").addClass("active"))},updateDirectionControls=function(){1==getPagerQty()?(slider.controls.prev.addClass("disabled"),slider.controls.next.addClass("disabled")):!slider.settings.infiniteLoop&&slider.settings.hideControlOnEnd&&(0==slider.active.index?(slider.controls.prev.addClass("disabled"),slider.controls.next.removeClass("disabled")):slider.active.index==getPagerQty()-1?(slider.controls.next.addClass("disabled"),slider.controls.prev.removeClass("disabled")):(slider.controls.prev.removeClass("disabled"),slider.controls.next.removeClass("disabled")))},initAuto=function(){if(slider.settings.autoDelay>0){setTimeout(el.startAuto,slider.settings.autoDelay)}else el.startAuto();slider.settings.autoHover&&el.hover(function(){slider.interval&&(el.stopAuto(!0),slider.autoPaused=!0)},function(){slider.autoPaused&&(el.startAuto(!0),slider.autoPaused=null)})},initTicker=function(){var startPosition=0;if("next"==slider.settings.autoDirection)el.append(slider.children.clone().addClass("bx-clone"));else{el.prepend(slider.children.clone().addClass("bx-clone"));var position=slider.children.first().position();startPosition="horizontal"==slider.settings.mode?-position.left:-position.top}setPositionProperty(startPosition,"reset",0),slider.settings.pager=!1,slider.settings.controls=!1,slider.settings.autoControls=!1,slider.settings.tickerHover&&!slider.usingCSS&&slider.viewport.hover(function(){el.stop()},function(){var totalDimens=0;slider.children.each(function(){totalDimens+="horizontal"==slider.settings.mode?$(this).outerWidth(!0):$(this).outerHeight(!0)});var ratio=slider.settings.speed/totalDimens,property="horizontal"==slider.settings.mode?"left":"top",newSpeed=ratio*(totalDimens-Math.abs(parseInt(el.css(property))));tickerLoop(newSpeed)}),tickerLoop()},tickerLoop=function(resumeSpeed){speed=resumeSpeed?resumeSpeed:slider.settings.speed;var position={left:0,top:0},reset={left:0,top:0};"next"==slider.settings.autoDirection?position=el.find(".bx-clone").first().position():reset=slider.children.first().position();var animateProperty="horizontal"==slider.settings.mode?-position.left:-position.top,resetValue="horizontal"==slider.settings.mode?-reset.left:-reset.top,params={resetValue:resetValue};setPositionProperty(animateProperty,"ticker",speed,params)},initTouch=function(){slider.touch={start:{x:0,y:0},end:{x:0,y:0}},slider.viewport.bind("touchstart",onTouchStart)},onTouchStart=function(e){if(slider.working)e.preventDefault();else{slider.touch.originalPos=el.position();var orig=e.originalEvent;slider.touch.start.x=orig.changedTouches[0].pageX,slider.touch.start.y=orig.changedTouches[0].pageY,slider.viewport.bind("touchmove",onTouchMove),slider.viewport.bind("touchend",onTouchEnd)}},onTouchMove=function(e){var orig=e.originalEvent,xMovement=Math.abs(orig.changedTouches[0].pageX-slider.touch.start.x),yMovement=Math.abs(orig.changedTouches[0].pageY-slider.touch.start.y);if(3*xMovement>yMovement&&slider.settings.preventDefaultSwipeX?e.preventDefault():3*yMovement>xMovement&&slider.settings.preventDefaultSwipeY&&e.preventDefault(),"fade"!=slider.settings.mode&&slider.settings.oneToOneTouch){var value=0;if("horizontal"==slider.settings.mode){var change=orig.changedTouches[0].pageX-slider.touch.start.x;value=slider.touch.originalPos.left+change}else{var change=orig.changedTouches[0].pageY-slider.touch.start.y;value=slider.touch.originalPos.top+change}setPositionProperty(value,"reset",0)}},onTouchEnd=function(e){slider.viewport.unbind("touchmove",onTouchMove);var orig=e.originalEvent,value=0;if(slider.touch.end.x=orig.changedTouches[0].pageX,slider.touch.end.y=orig.changedTouches[0].pageY,"fade"==slider.settings.mode){var distance=Math.abs(slider.touch.start.x-slider.touch.end.x);distance>=slider.settings.swipeThreshold&&(slider.touch.start.x>slider.touch.end.x?el.goToNextSlide():el.goToPrevSlide(),el.stopAuto())}else{var distance=0;"horizontal"==slider.settings.mode?(distance=slider.touch.end.x-slider.touch.start.x,value=slider.touch.originalPos.left):(distance=slider.touch.end.y-slider.touch.start.y,value=slider.touch.originalPos.top),!slider.settings.infiniteLoop&&(0==slider.active.index&&distance>0||slider.active.last&&0>distance)?setPositionProperty(value,"reset",200):Math.abs(distance)>=slider.settings.swipeThreshold?(0>distance?el.goToNextSlide():el.goToPrevSlide(),el.stopAuto()):setPositionProperty(value,"reset",200)}slider.viewport.unbind("touchend",onTouchEnd)},resizeWindow=function(){if(slider.initialized){var windowWidthNew=$(window).width(),windowHeightNew=$(window).height();(windowWidth!=windowWidthNew||windowHeight!=windowHeightNew)&&(windowWidth=windowWidthNew,windowHeight=windowHeightNew,el.redrawSlider(),slider.settings.onSliderResize.call(el,slider.active.index))}};return el.goToSlide=function(slideIndex,direction){if(!slider.working&&slider.active.index!=slideIndex)if(slider.working=!0,slider.oldIndex=slider.active.index,slider.active.index=0>slideIndex?getPagerQty()-1:slideIndex>=getPagerQty()?0:slideIndex,slider.settings.onSlideBefore(slider.children.eq(slider.active.index),slider.oldIndex,slider.active.index),"next"==direction?slider.settings.onSlideNext(slider.children.eq(slider.active.index),slider.oldIndex,slider.active.index):"prev"==direction&&slider.settings.onSlidePrev(slider.children.eq(slider.active.index),slider.oldIndex,slider.active.index),slider.active.last=slider.active.index>=getPagerQty()-1,slider.settings.pager&&updatePagerActive(slider.active.index),slider.settings.controls&&updateDirectionControls(),"fade"==slider.settings.mode)slider.settings.adaptiveHeight&&slider.viewport.height()!=getViewportHeight()&&slider.viewport.animate({height:getViewportHeight()},slider.settings.adaptiveHeightSpeed),slider.children.filter(":visible").fadeOut(slider.settings.speed).css({zIndex:0}),slider.children.eq(slider.active.index).css("zIndex",slider.settings.slideZIndex+1).fadeIn(slider.settings.speed,function(){$(this).css("zIndex",slider.settings.slideZIndex),updateAfterSlideTransition()});else{slider.settings.adaptiveHeight&&slider.viewport.height()!=getViewportHeight()&&slider.viewport.animate({height:getViewportHeight()},slider.settings.adaptiveHeightSpeed);var moveBy=0,position={left:0,top:0};if(!slider.settings.infiniteLoop&&slider.carousel&&slider.active.last)if("horizontal"==slider.settings.mode){var lastChild=slider.children.eq(slider.children.length-1);position=lastChild.position(),moveBy=slider.viewport.width()-lastChild.outerWidth()}else{var lastShowingIndex=slider.children.length-slider.settings.minSlides;position=slider.children.eq(lastShowingIndex).position()}else if(slider.carousel&&slider.active.last&&"prev"==direction){var eq=1==slider.settings.moveSlides?slider.settings.maxSlides-getMoveBy():(getPagerQty()-1)*getMoveBy()-(slider.children.length-slider.settings.maxSlides),lastChild=el.children(".bx-clone").eq(eq);position=lastChild.position()}else if("next"==direction&&0==slider.active.index)position=el.find("> .bx-clone").eq(slider.settings.maxSlides).position(),slider.active.last=!1;else if(slideIndex>=0){var requestEl=slideIndex*getMoveBy();position=slider.children.eq(requestEl).position()}if("undefined"!=typeof position){var value="horizontal"==slider.settings.mode?-(position.left-moveBy):-position.top;setPositionProperty(value,"slide",slider.settings.speed)}}},el.goToNextSlide=function(){if(slider.settings.infiniteLoop||!slider.active.last){var pagerIndex=parseInt(slider.active.index)+1;el.goToSlide(pagerIndex,"next")}},el.goToPrevSlide=function(){if(slider.settings.infiniteLoop||0!=slider.active.index){var pagerIndex=parseInt(slider.active.index)-1;el.goToSlide(pagerIndex,"prev")}},el.startAuto=function(preventControlUpdate){slider.interval||(slider.interval=setInterval(function(){"next"==slider.settings.autoDirection?el.goToNextSlide():el.goToPrevSlide()},slider.settings.pause),slider.settings.autoControls&&1!=preventControlUpdate&&updateAutoControls("stop"))},el.stopAuto=function(preventControlUpdate){slider.interval&&(clearInterval(slider.interval),slider.interval=null,slider.settings.autoControls&&1!=preventControlUpdate&&updateAutoControls("start"))},el.getCurrentSlide=function(){return slider.active.index},el.getCurrentSlideElement=function(){return slider.children.eq(slider.active.index)},el.getSlideCount=function(){return slider.children.length},el.redrawSlider=function(){slider.children.add(el.find(".bx-clone")).width(getSlideWidth()),slider.viewport.css("height",getViewportHeight()),slider.settings.ticker||setSlidePosition(),slider.active.last&&(slider.active.index=getPagerQty()-1),slider.active.index>=getPagerQty()&&(slider.active.last=!0),slider.settings.pager&&!slider.settings.pagerCustom&&(populatePager(),updatePagerActive(slider.active.index))},el.destroySlider=function(){slider.initialized&&(slider.initialized=!1,$(".bx-clone",this).remove(),slider.children.each(function(){void 0!=$(this).data("origStyle")?$(this).attr("style",$(this).data("origStyle")):$(this).removeAttr("style")}),void 0!=$(this).data("origStyle")?this.attr("style",$(this).data("origStyle")):$(this).removeAttr("style"),$(this).unwrap().unwrap(),slider.controls.el&&slider.controls.el.remove(),slider.controls.next&&slider.controls.next.remove(),slider.controls.prev&&slider.controls.prev.remove(),slider.pagerEl&&slider.settings.controls&&slider.pagerEl.remove(),$(".bx-caption",this).remove(),slider.controls.autoEl&&slider.controls.autoEl.remove(),clearInterval(slider.interval),slider.settings.responsive&&$(window).unbind("resize",resizeWindow))},el.reloadSlider=function(settings){void 0!=settings&&(options=settings),el.destroySlider(),init()},init(),this}}(jQuery),function($,window,document,undefined){"use strict";function removeQuotes(string){return("string"==typeof string||string instanceof String)&&(string=string.replace(/^['\\/"]+|(;\s?})+|['\\/"]+$/g,"")),string}var header_helpers=function(class_array){for(var i=class_array.length,head=$("head");i--;)0===head.has("."+class_array[i]).length&&head.append('<meta class="'+class_array[i]+'" />')};header_helpers(["foundation-mq-small","foundation-mq-medium","foundation-mq-large","foundation-mq-xlarge","foundation-mq-xxlarge","foundation-data-attribute-namespace"]),$(function(){"undefined"!=typeof FastClick&&"undefined"!=typeof document.body&&FastClick.attach(document.body)});var S=function(selector,context){if("string"==typeof selector){if(context){var cont;if(context.jquery){if(cont=context[0],!cont)return context}else cont=context;return $(cont.querySelectorAll(selector))}return $(document.querySelectorAll(selector))}return $(selector,context)},attr_name=function(init){var arr=[];return init||arr.push("data"),this.namespace.length>0&&arr.push(this.namespace),arr.push(this.name),arr.join("-")},add_namespace=function(str){for(var parts=str.split("-"),i=parts.length,arr=[];i--;)0!==i?arr.push(parts[i]):this.namespace.length>0?arr.push(this.namespace,parts[i]):arr.push(parts[i]);return arr.reverse().join("-")},bindings=function(method,options){var self=this,should_bind_events=!S(this).data(this.attr_name(!0));return S(this.scope).is("["+this.attr_name()+"]")?(S(this.scope).data(this.attr_name(!0)+"-init",$.extend({},this.settings,options||method,this.data_options(S(this.scope)))),should_bind_events&&this.events(this.scope)):S("["+this.attr_name()+"]",this.scope).each(function(){var should_bind_events=!S(this).data(self.attr_name(!0)+"-init");S(this).data(self.attr_name(!0)+"-init",$.extend({},self.settings,options||method,self.data_options(S(this)))),should_bind_events&&self.events(this)}),"string"==typeof method?this[method].call(this,options):void 0},single_image_loaded=function(image,callback){function loaded(){callback(image[0])}function bindLoad(){if(this.one("load",loaded),/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var src=this.attr("src"),param=src.match(/\?/)?"&":"?";param+="random="+(new Date).getTime(),this.attr("src",src+param)}}return image.attr("src")?void(image[0].complete||4===image[0].readyState?loaded():bindLoad.call(image)):void loaded()};window.matchMedia=window.matchMedia||function(doc){var bool,docElem=doc.documentElement,refNode=docElem.firstElementChild||docElem.firstChild,fakeBody=doc.createElement("body"),div=doc.createElement("div");return div.id="mq-test-1",div.style.cssText="position:absolute;top:-100em",fakeBody.style.background="none",fakeBody.appendChild(div),function(q){return div.innerHTML='&shy;<style media="'+q+'"> #mq-test-1 { width: 42px; }</style>',docElem.insertBefore(fakeBody,refNode),bool=42===div.offsetWidth,docElem.removeChild(fakeBody),{matches:bool,media:q}}}(document),function(){function raf(){animating&&(requestAnimationFrame(raf),jqueryFxAvailable&&jQuery.fx.tick())}for(var animating,lastTime=0,vendors=["webkit","moz"],requestAnimationFrame=window.requestAnimationFrame,cancelAnimationFrame=window.cancelAnimationFrame,jqueryFxAvailable="undefined"!=typeof jQuery.fx;lastTime<vendors.length&&!requestAnimationFrame;lastTime++)requestAnimationFrame=window[vendors[lastTime]+"RequestAnimationFrame"],cancelAnimationFrame=cancelAnimationFrame||window[vendors[lastTime]+"CancelAnimationFrame"]||window[vendors[lastTime]+"CancelRequestAnimationFrame"];requestAnimationFrame?(window.requestAnimationFrame=requestAnimationFrame,window.cancelAnimationFrame=cancelAnimationFrame,jqueryFxAvailable&&(jQuery.fx.timer=function(timer){timer()&&jQuery.timers.push(timer)&&!animating&&(animating=!0,raf())},jQuery.fx.stop=function(){animating=!1})):(window.requestAnimationFrame=function(callback){var currTime=(new Date).getTime(),timeToCall=Math.max(0,16-(currTime-lastTime)),id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);return lastTime=currTime+timeToCall,id},window.cancelAnimationFrame=function(id){clearTimeout(id)})}(jQuery),window.Foundation={name:"Foundation",version:"5.4.5",media_queries:{small:S(".foundation-mq-small").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,""),medium:S(".foundation-mq-medium").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,""),large:S(".foundation-mq-large").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,""),xlarge:S(".foundation-mq-xlarge").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,""),xxlarge:S(".foundation-mq-xxlarge").css("font-family").replace(/^[\/\\'"]+|(;\s?})+|[\/\\'"]+$/g,"")},stylesheet:$("<style></style>").appendTo("head")[0].sheet,global:{namespace:undefined},init:function(scope,libraries,method,options,response){var args=[scope,method,options,response],responses=[];if(this.rtl=/rtl/i.test(S("html").attr("dir")),this.scope=scope||this.scope,this.set_namespace(),libraries&&"string"==typeof libraries&&!/reflow/i.test(libraries))this.libs.hasOwnProperty(libraries)&&responses.push(this.init_lib(libraries,args));else for(var lib in this.libs)responses.push(this.init_lib(lib,libraries));return S(window).load(function(){S(window).trigger("resize.fndtn.clearing").trigger("resize.fndtn.dropdown").trigger("resize.fndtn.equalizer").trigger("resize.fndtn.interchange").trigger("resize.fndtn.joyride").trigger("resize.fndtn.magellan").trigger("resize.fndtn.topbar").trigger("resize.fndtn.slider")}),scope},init_lib:function(lib,args){return this.libs.hasOwnProperty(lib)?(this.patch(this.libs[lib]),args&&args.hasOwnProperty(lib)?("undefined"!=typeof this.libs[lib].settings?$.extend(!0,this.libs[lib].settings,args[lib]):"undefined"!=typeof this.libs[lib].defaults&&$.extend(!0,this.libs[lib].defaults,args[lib]),this.libs[lib].init.apply(this.libs[lib],[this.scope,args[lib]])):(args=args instanceof Array?args:new Array(args),this.libs[lib].init.apply(this.libs[lib],args))):function(){}},patch:function(lib){lib.scope=this.scope,lib.namespace=this.global.namespace,lib.rtl=this.rtl,lib.data_options=this.utils.data_options,lib.attr_name=attr_name,lib.add_namespace=add_namespace,lib.bindings=bindings,lib.S=this.utils.S},inherit:function(scope,methods){for(var methods_arr=methods.split(" "),i=methods_arr.length;i--;)this.utils.hasOwnProperty(methods_arr[i])&&(scope[methods_arr[i]]=this.utils[methods_arr[i]])},set_namespace:function(){var namespace=this.global.namespace===undefined?$(".foundation-data-attribute-namespace").css("font-family"):this.global.namespace;this.global.namespace=namespace===undefined||/false/i.test(namespace)?"":namespace},libs:{},utils:{S:S,throttle:function(func,delay){var timer=null;return function(){var context=this,args=arguments;null==timer&&(timer=setTimeout(function(){func.apply(context,args),timer=null},delay))}},debounce:function(func,delay,immediate){var timeout,result;return function(){var context=this,args=arguments,later=function(){timeout=null,immediate||(result=func.apply(context,args))},callNow=immediate&&!timeout;return clearTimeout(timeout),timeout=setTimeout(later,delay),callNow&&(result=func.apply(context,args)),result}},data_options:function(el,data_attr_name){function isNumber(o){return!isNaN(o-0)&&null!==o&&""!==o&&o!==!1&&o!==!0}function trim(str){return"string"==typeof str?$.trim(str):str}data_attr_name=data_attr_name||"options";var ii,p,opts_arr,opts={},data_options=function(el){var namespace=Foundation.global.namespace;return el.data(namespace.length>0?namespace+"-"+data_attr_name:data_attr_name)},cached_options=data_options(el);if("object"==typeof cached_options)return cached_options;for(opts_arr=(cached_options||":").split(";"),ii=opts_arr.length;ii--;)p=opts_arr[ii].split(":"),p=[p[0],p.slice(1).join(":")],/true/i.test(p[1])&&(p[1]=!0),/false/i.test(p[1])&&(p[1]=!1),isNumber(p[1])&&(p[1]=-1===p[1].indexOf(".")?parseInt(p[1],10):parseFloat(p[1])),2===p.length&&p[0].length>0&&(opts[trim(p[0])]=trim(p[1]));return opts},register_media:function(media,media_class){Foundation.media_queries[media]===undefined&&($("head").append('<meta class="'+media_class+'"/>'),Foundation.media_queries[media]=removeQuotes($("."+media_class).css("font-family")))},add_custom_rule:function(rule,media){if(media===undefined&&Foundation.stylesheet)Foundation.stylesheet.insertRule(rule,Foundation.stylesheet.cssRules.length);else{var query=Foundation.media_queries[media];query!==undefined&&Foundation.stylesheet.insertRule("@media "+Foundation.media_queries[media]+"{ "+rule+" }")}},image_loaded:function(images,callback){var self=this,unloaded=images.length;0===unloaded&&callback(images),images.each(function(){single_image_loaded(self.S(this),function(){unloaded-=1,0===unloaded&&callback(images)})})},random_str:function(){return this.fidx||(this.fidx=0),this.prefix=this.prefix||[this.name||"F",(+new Date).toString(36)].join("-"),this.prefix+(this.fidx++).toString(36)}}},$.fn.foundation=function(){var args=Array.prototype.slice.call(arguments,0);return this.each(function(){return Foundation.init.apply(Foundation,[this].concat(args)),this})}}(jQuery,window,window.document),function($,window,document,undefined){"use strict";function getAnimationData(str){var fade=/fade/i.test(str),pop=/pop/i.test(str);return{animate:fade||pop,pop:pop,fade:fade}}Foundation.libs.reveal={name:"reveal",version:"5.4.5",locked:!1,settings:{animation:"fadeAndPop",animation_speed:250,close_on_background_click:!0,close_on_esc:!0,dismiss_modal_class:"close-reveal-modal",bg_class:"reveal-modal-bg",root_element:"body",open:function(){},opened:function(){},close:function(){},closed:function(){},bg:$(".reveal-modal-bg"),css:{open:{opacity:0,visibility:"visible",display:"block"},close:{opacity:1,visibility:"hidden",display:"none"}}},init:function(scope,method,options){$.extend(!0,this.settings,method,options),this.bindings(method,options)},events:function(){var self=this,S=self.S;return S(this.scope).off(".reveal").on("click.fndtn.reveal","["+this.add_namespace("data-reveal-id")+"]:not([disabled])",function(e){if(e.preventDefault(),!self.locked){var element=S(this),ajax=element.data(self.data_attr("reveal-ajax"));if(self.locked=!0,"undefined"==typeof ajax)self.open.call(self,element);else{var url=ajax===!0?element.attr("href"):ajax;self.open.call(self,element,{url:url})}}}),S(document).on("click.fndtn.reveal",this.close_targets(),function(e){if(e.preventDefault(),!self.locked){var settings=S("["+self.attr_name()+"].open").data(self.attr_name(!0)+"-init"),bg_clicked=S(e.target)[0]===S("."+(settings?settings.bg_class:null))[0];if(bg_clicked){if(!settings.close_on_background_click)return;e.stopPropagation()}self.locked=!0,self.close.call(self,bg_clicked?S("["+self.attr_name()+"].open"):S(this).closest("["+self.attr_name()+"]"))}}),S("["+self.attr_name()+"]",this.scope).length>0?S(this.scope).on("open.fndtn.reveal",this.settings.open).on("opened.fndtn.reveal",this.settings.opened).on("opened.fndtn.reveal",this.open_video).on("close.fndtn.reveal",this.settings.close).on("closed.fndtn.reveal",this.settings.closed).on("closed.fndtn.reveal",this.close_video):S(this.scope).on("open.fndtn.reveal","["+self.attr_name()+"]",this.settings.open).on("opened.fndtn.reveal","["+self.attr_name()+"]",this.settings.opened).on("opened.fndtn.reveal","["+self.attr_name()+"]",this.open_video).on("close.fndtn.reveal","["+self.attr_name()+"]",this.settings.close).on("closed.fndtn.reveal","["+self.attr_name()+"]",this.settings.closed).on("closed.fndtn.reveal","["+self.attr_name()+"]",this.close_video),!0},key_up_on:function(){var self=this;return self.S("body").off("keyup.fndtn.reveal").on("keyup.fndtn.reveal",function(event){var open_modal=self.S("["+self.attr_name()+"].open"),settings=open_modal.data(self.attr_name(!0)+"-init")||self.settings;settings&&27===event.which&&settings.close_on_esc&&!self.locked&&self.close.call(self,open_modal)}),!0},key_up_off:function(){return this.S("body").off("keyup.fndtn.reveal"),!0},open:function(target,ajax_settings){var modal,self=this;target?"undefined"!=typeof target.selector?modal=self.S("#"+target.data(self.data_attr("reveal-id"))).first():(modal=self.S(this.scope),ajax_settings=target):modal=self.S(this.scope);var settings=modal.data(self.attr_name(!0)+"-init");if(settings=settings||this.settings,modal.hasClass("open")&&target.attr("data-reveal-id")==modal.attr("id"))return self.close(modal);if(!modal.hasClass("open")){var open_modal=self.S("["+self.attr_name()+"].open");if("undefined"==typeof modal.data("css-top")&&modal.data("css-top",parseInt(modal.css("top"),10)).data("offset",this.cache_offset(modal)),this.key_up_on(modal),modal.trigger("open").trigger("open.fndtn.reveal"),open_modal.length<1&&this.toggle_bg(modal,!0),"string"==typeof ajax_settings&&(ajax_settings={url:ajax_settings}),"undefined"!=typeof ajax_settings&&ajax_settings.url){var old_success="undefined"!=typeof ajax_settings.success?ajax_settings.success:null;$.extend(ajax_settings,{success:function(data,textStatus,jqXHR){$.isFunction(old_success)&&old_success(data,textStatus,jqXHR),modal.html(data),self.S(modal).foundation("section","reflow"),self.S(modal).children().foundation(),open_modal.length>0&&self.hide(open_modal,settings.css.close),self.show(modal,settings.css.open)}}),$.ajax(ajax_settings)}else open_modal.length>0&&this.hide(open_modal,settings.css.close),this.show(modal,settings.css.open)}self.S(window).trigger("resize")},close:function(modal){var modal=modal&&modal.length?modal:this.S(this.scope),open_modals=this.S("["+this.attr_name()+"].open"),settings=modal.data(this.attr_name(!0)+"-init")||this.settings;open_modals.length>0&&(this.locked=!0,this.key_up_off(modal),modal.trigger("close").trigger("close.fndtn.reveal"),this.toggle_bg(modal,!1),this.hide(open_modals,settings.css.close,settings))},close_targets:function(){var base="."+this.settings.dismiss_modal_class;return this.settings.close_on_background_click?base+", ."+this.settings.bg_class:base},toggle_bg:function(modal,state){0===this.S("."+this.settings.bg_class).length&&(this.settings.bg=$("<div />",{"class":this.settings.bg_class}).appendTo("body").hide());var visible=this.settings.bg.filter(":visible").length>0;state!=visible&&((state==undefined?visible:!state)?this.hide(this.settings.bg):this.show(this.settings.bg))},show:function(el,css){if(css){var settings=el.data(this.attr_name(!0)+"-init")||this.settings,root_element=settings.root_element;if(0===el.parent(root_element).length){var placeholder=el.wrap('<div style="display: none;" />').parent();el.on("closed.fndtn.reveal.wrapped",function(){el.detach().appendTo(placeholder),el.unwrap().unbind("closed.fndtn.reveal.wrapped")}),el.detach().appendTo(root_element)}var animData=getAnimationData(settings.animation);if(animData.animate||(this.locked=!1),animData.pop){css.top=$(window).scrollTop()-el.data("offset")+"px";var end_css={top:$(window).scrollTop()+el.data("css-top")+"px",opacity:1};return setTimeout(function(){return el.css(css).animate(end_css,settings.animation_speed,"linear",function(){this.locked=!1,el.trigger("opened").trigger("opened.fndtn.reveal")}.bind(this)).addClass("open")}.bind(this),settings.animation_speed/2)}if(animData.fade){css.top=$(window).scrollTop()+el.data("css-top")+"px";var end_css={opacity:1};return setTimeout(function(){return el.css(css).animate(end_css,settings.animation_speed,"linear",function(){this.locked=!1,el.trigger("opened").trigger("opened.fndtn.reveal")}.bind(this)).addClass("open")}.bind(this),settings.animation_speed/2)}return el.css(css).show().css({opacity:1}).addClass("open").trigger("opened").trigger("opened.fndtn.reveal")}var settings=this.settings;return getAnimationData(settings.animation).fade?el.fadeIn(settings.animation_speed/2):(this.locked=!1,el.show())},hide:function(el,css){if(css){var settings=el.data(this.attr_name(!0)+"-init");settings=settings||this.settings;var animData=getAnimationData(settings.animation);if(animData.animate||(this.locked=!1),animData.pop){var end_css={top:-$(window).scrollTop()-el.data("offset")+"px",opacity:0};return setTimeout(function(){return el.animate(end_css,settings.animation_speed,"linear",function(){this.locked=!1,el.css(css).trigger("closed").trigger("closed.fndtn.reveal")}.bind(this)).removeClass("open")}.bind(this),settings.animation_speed/2)}if(animData.fade){var end_css={opacity:0};return setTimeout(function(){return el.animate(end_css,settings.animation_speed,"linear",function(){this.locked=!1,el.css(css).trigger("closed").trigger("closed.fndtn.reveal")}.bind(this)).removeClass("open")}.bind(this),settings.animation_speed/2)}return el.hide().css(css).removeClass("open").trigger("closed").trigger("closed.fndtn.reveal")}var settings=this.settings;return getAnimationData(settings.animation).fade?el.fadeOut(settings.animation_speed/2):el.hide()},close_video:function(e){var video=$(".flex-video",e.target),iframe=$("iframe",video);iframe.length>0&&(iframe.attr("data-src",iframe[0].src),iframe.attr("src",iframe.attr("src")),video.hide())},open_video:function(e){var video=$(".flex-video",e.target),iframe=video.find("iframe");if(iframe.length>0){var data_src=iframe.attr("data-src");if("string"==typeof data_src)iframe[0].src=iframe.attr("data-src");else{var src=iframe[0].src;iframe[0].src=undefined,iframe[0].src=src}video.show()}},data_attr:function(str){return this.namespace.length>0?this.namespace+"-"+str:str},cache_offset:function(modal){var offset=modal.show().height()+parseInt(modal.css("top"),10);return modal.hide(),offset},off:function(){$(this.scope).off(".fndtn.reveal")},reflow:function(){}}}(jQuery,window,window.document),function(){"use strict";{var angularAppDir="/app/code/local/Pan/JewelryDesigner/app",origin=window.location.protocol+"//"+window.location.host,viewsUrlPath=origin+angularAppDir+"/views",partialsUrlPath=viewsUrlPath+"/partials",appImgDir=origin+angularAppDir+"/img",appCssDir=origin+angularAppDir+"/css",appJsDir=origin+angularAppDir+"/js",appNavTemplateUrlPath=partialsUrlPath+"/navbar.html",skinUrlPrefix="//skin/frontend/shopper/pan/";angular.module("jewelryDesigner",["ui.router","ngSanitize","ngResource","infinite-scroll"]).config(["$stateProvider","$urlRouterProvider","$httpProvider",function($stateProvider,$urlRouterProvider,$httpProvider){$httpProvider.defaults.headers.common["Cache-Control"]="no-cache",$urlRouterProvider.otherwise("/"),$stateProvider.state("home",{url:"/",templateUrl:viewsUrlPath+"/home.html",controller:"HomeCtrl"}).state("ui",{"abstract":!0,url:"/design/:designId",views:{"":{templateUrl:viewsUrlPath+"/ui.html",controller:"UiCtrl"},"workspace@ui":{templateUrl:partialsUrlPath+"/ui/workspace.html",controller:"WorkspaceCtrl"},"navbar@ui":{templateUrl:partialsUrlPath+"/ui/navbar.html",controller:"WorkspaceCtrl",resolve:{designId:["$stateParams",function($stateParams){return $stateParams.designId}]}},"topnav@ui":{templateUrl:partialsUrlPath+"/ui/topnav.html",controller:"WorkspaceCtrl",resolve:{designId:["$stateParams",function($stateParams){return $stateParams.designId}]}}}}).state("ui.bracelets",{url:"/bracelets",views:{"sidebar@ui":{templateUrl:partialsUrlPath+"/designersteps/bracelets.html",controller:"BraceletsCtrl",resolve:{products:["Product",function(Product){return angular.element(".loader").hasClass("hidden")&&angular.element(".loader").removeClass("hidden"),Product.query({type:"bracelets"}).$promise}]}}}}).state("ui.charms",{url:"/charms",views:{"sidebar@ui":{templateUrl:partialsUrlPath+"/designersteps/charms.html",controller:"CharmsCtrl",resolve:{products:["Product",function(Product){return angular.element(".loader").hasClass("hidden")&&angular.element(".loader").removeClass("hidden"),Product.query({type:"charms"}).$promise}]}}}}).state("ui.clips",{url:"/clips",views:{"sidebar@ui":{templateUrl:partialsUrlPath+"/designersteps/clips.html",controller:"ClipsCtrl",resolve:{products:["Product",function(Product){return angular.element(".loader").hasClass("hidden")&&angular.element(".loader").removeClass("hidden"),Product.query({type:"clips"}).$promise}]}}}}).state("ui.finish",{url:"/finish",views:{"sidebar@ui":{templateUrl:partialsUrlPath+"/designersteps/finish.html",controller:"FinishCtrl"}}}).state("ui.review",{url:"/review",views:{"sidebar@ui":{templateUrl:partialsUrlPath+"/designersteps/review.html",controller:"ReviewCtrl",resolve:{wsBracelet:["$rootScope",function(){angular.element(".loader").hasClass("hidden")&&angular.element(".loader").removeClass("hidden");var bracelet=PAN.DesignerWorkspace.getCurrentBracelet();return bracelet}]}}}}).state("ui.share",{url:"/share",views:{"topnav@ui":{templateUrl:partialsUrlPath+"/ui/share/topnav.html",controller:"ShareNavCtrl"},"navbar@ui":{template:"",controller:"ShareNavCtrl"},"workspace@ui":{templateUrl:partialsUrlPath+"/ui/share/workspace.html",controller:"ShareWorkspaceCtrl",resolve:{design:["$stateParams","Design",function($stateParams,Design){return Design.get({id:$stateParams.designId,allow_anonymous:1}).$promise
}]}},"sidebar@ui":{templateUrl:partialsUrlPath+"/ui/share/sidebar.html",controller:"ShareSidebarCtrl",resolve:{design:["$stateParams","Design",function($stateParams,Design){return Design.get({id:$stateParams.designId,allow_anonymous:1}).$promise}]}}}}).state("inspiration",{url:"/inspiration",templateUrl:viewsUrlPath+"/inspiration.html",controller:"InspirationsCtrl"}).state("mydesigns",{url:"/my-designs",templateUrl:viewsUrlPath+"/design-list.html",controller:"MyDesignsCtrl"})}]).run(function($rootScope){$rootScope.viewsUrlPath=viewsUrlPath,$rootScope.partialsUrlPath=partialsUrlPath,$rootScope.appImgDir=appImgDir,$rootScope.appCssDir=appCssDir,$rootScope.appJsDir=appJsDir,$rootScope.appNavTemplateUrlPath=appNavTemplateUrlPath,$rootScope.skinUrlPrefix=origin+skinUrlPrefix})}}(),angular.module("jewelryDesigner").controller("BraceletsCtrl",["$scope","$stateParams","$document","products",function($scope,$stateParams,$document,products){$scope.designStep="bracelets",$scope.colors=[],$scope.themes=[],$scope.materials=[],$scope.products=products,angular.element(".sidebar-toggle").addClass($scope.designStep).removeClass("review").removeClass("charms").removeClass("clips").removeClass("active"),$document.ready(function(){angular.element(".loader").hasClass("hidden")||angular.element(".loader").addClass("hidden")}),angular.forEach($scope.products,function(item){item.color instanceof Array?angular.forEach(item.color,function(c){null!==item.color&&-1==$scope.colors.indexOf(c)&&$scope.colors.push(c)}):null!==item.color&&-1==$scope.colors.indexOf(item.color)&&$scope.colors.push(item.color),item.theme instanceof Array?angular.forEach(item.theme,function(t){null!==item.theme&&-1==$scope.themes.indexOf(t)&&$scope.themes.push(t)}):null!==item.theme&&-1==$scope.themes.indexOf(item.theme)&&$scope.themes.push(item.theme),item.material instanceof Array?angular.forEach(item.material,function(m){null!==item.material&&-1==$scope.materials.indexOf(m)&&$scope.materials.push(m)}):null!==item.material&&-1==$scope.materials.indexOf(item.material)&&$scope.materials.push(item.material)})}]),angular.module("jewelryDesigner").controller("CharmsCtrl",["$scope","$stateParams","$document","products",function($scope,$stateParams,$document,products){$scope.designStep="charms",$scope.colors=[],$scope.themes=[],$scope.materials=[],$scope.products=products,angular.element(".sidebar-toggle").addClass($scope.designStep).removeClass("review").removeClass("bracelets").removeClass("clips").removeClass("active"),$document.ready(function(){angular.element(".loader").hasClass("hidden")||angular.element(".loader").addClass("hidden")}),angular.forEach($scope.products,function(item){item.color instanceof Array?angular.forEach(item.color,function(c){null!==item.color&&-1==$scope.colors.indexOf(c)&&$scope.colors.push(c)}):null!==item.color&&-1==$scope.colors.indexOf(item.color)&&$scope.colors.push(item.color),item.theme instanceof Array?angular.forEach(item.theme,function(t){null!==item.theme&&-1==$scope.themes.indexOf(t)&&$scope.themes.push(t)}):null!==item.theme&&-1==$scope.themes.indexOf(item.theme)&&$scope.themes.push(item.theme),item.material instanceof Array?angular.forEach(item.material,function(m){null!==item.material&&-1==$scope.materials.indexOf(m)&&$scope.materials.push(m)}):null!==item.material&&-1==$scope.materials.indexOf(item.material)&&$scope.materials.push(item.material)})}]),angular.module("jewelryDesigner").controller("ClipsCtrl",["$scope","$stateParams","$document","products",function($scope,$stateParams,$document,products){$scope.designStep="clips",$scope.colors=[],$scope.themes=[],$scope.materials=[],$scope.products=products,angular.element(".sidebar-toggle").addClass($scope.designStep).removeClass("review").removeClass("bracelets").removeClass("charms").removeClass("active"),$document.ready(function(){angular.element(".loader").hasClass("hidden")||angular.element(".loader").addClass("hidden")}),angular.forEach($scope.products,function(item){item.color instanceof Array?angular.forEach(item.color,function(c){null!==item.color&&-1==$scope.colors.indexOf(c)&&$scope.colors.push(c)}):null!==item.color&&-1==$scope.colors.indexOf(item.color)&&$scope.colors.push(item.color),item.theme instanceof Array?angular.forEach(item.theme,function(t){null!==item.theme&&-1==$scope.themes.indexOf(t)&&$scope.themes.push(t)}):null!==item.theme&&-1==$scope.themes.indexOf(item.theme)&&$scope.themes.push(item.theme),item.material instanceof Array?angular.forEach(item.material,function(m){null!==item.material&&-1==$scope.materials.indexOf(m)&&$scope.materials.push(m)}):null!==item.material&&-1==$scope.materials.indexOf(item.material)&&$scope.materials.push(item.material)})}]),angular.module("jewelryDesigner").controller("DesignCtrl",["$scope","$rootScope","$stateParams","$document","$window","Design",function($scope,$rootScope,$stateParams,$document,$window,Design){angular.element(".main-container").removeClass("hero-splash");var win=angular.element($window);win.bind("resize",function(){PAN.DesignerWorkspace.reloadDesignOnResize()}),$scope.inAdminArea=!1,$scope.design=Design.get({id:$stateParams.designId}),$scope.design.$promise.then(function(design){void 0!==design.id?($scope.design=design,$scope.designId=design.id,PAN.DesignerWorkspace.setCurrentDesignId(design.id)):($scope.design=null,$scope.designId="new"),PAN.DesignerWorkspace.startOver(!1),PAN.DesignerWorkspace.loadDesign($scope.design),$document.ready(function(){if($scope.inAdminArea=jQuery(".designer_app_wrapper").hasClass("admin"),$scope.inAdminArea&&null!==$scope.design){var inspirationCheckBox=jQuery("#inspiration_chkbox"),availableCheckBox=jQuery("#is_available_chkbox");inspirationCheckBox.prop("checked",$scope.design.is_inspiration_design),availableCheckBox.prop("checked",$scope.design.is_available)}}),$rootScope.$emit("design_loaded",design)})}]),angular.module("jewelryDesigner").controller("FinishCtrl",["$scope","$stateParams",function($scope){$scope.designStep="finish",angular.element(".sidebar-toggle").addClass($scope.designStep)}]),angular.module("jewelryDesigner").controller("HomeCtrl",["$scope","$stateParams","$rootScope","$document",function($scope,$stateParams,$rootScope,$document){$scope.title="Jewelry Designer",$scope.designId="new",angular.element(".main-container").addClass("hero-splash"),$document.ready(function(){angular.element(".loader").hasClass("hidden")||angular.element(".loader").addClass("hidden")})}]),angular.module("jewelryDesigner").controller("InspirationsCtrl",["$scope","$state","$stateParams","$rootScope","$document","Design",function($scope,$state,$stateParams,$rootScope,$document,Design){angular.element(".main-container").removeClass("hero-splash"),$document.ready(function(){angular.element(".loader").hasClass("hidden")||angular.element(".loader").addClass("hidden")}),$scope.title="Inspiration Bracelets",$scope.inAdminArea=!1,$scope.formKey=null,$document.ready(function(){$scope.inAdminArea=jQuery(".designer_app_wrapper").hasClass("admin"),$scope.inAdminArea&&($scope.formKey=jQuery(".designer_app_wrapper").data("form-key"))}),$scope.designs=Design.query({form_key:$scope.formKey,inspirations:1}),$scope.designs.$promise.then(function(){}),$scope.cloneDesign=function(designId){var ajaxUrl="/jewelrydesigner/api/cloneDesign";$document.ready(function(){$scope.inAdminArea=jQuery(".designer_app_wrapper").hasClass("admin"),$scope.inAdminArea&&(ajaxUrl="/jewelrydesigner/adminhtml_api/cloneDesign")}),jQuery.ajax({url:ajaxUrl,type:"POST",dataType:"json",data:{id:designId,form_key:$scope.formKey}}).done(function(data){data.error===!1&&$state.go("ui.review",{designId:data.design_id}),PAN.DesignerWorkspace.showMessage(data.message)})},$scope.addToWishlist=function(designId){var design=Design.get({form_key:$scope.formKey,id:designId,scope_to_customer:0});design.$promise.then(function(data){var productsAsJson=data.configuration;jQuery.ajax({url:"/jewelrydesigner/api/addToWishlist",type:"POST",dataType:"json",data:{products:productsAsJson}}).done(function(data){PAN.DesignerWorkspace.showMessage(data.message)})})},$scope.addToCart=function(designId){var design=Design.get({form_key:$scope.formKey,id:designId,scope_to_customer:0});design.$promise.then(function(data){var productsAsJson=data.configuration;jQuery.ajax({url:"/jewelrydesigner/api/addToCart",type:"POST",dataType:"json",data:{products:productsAsJson}}).done(function(data){data.error===!1&&jQuery(".top-dropdowns .ajax-cart-update-wrapper").html(data.cartTop),PAN.DesignerWorkspace.showMessage(data.message)})})},$scope.showDesigns=function(){var showDesigns=$scope.designs.length>0?!0:!1;return showDesigns},$scope.isAdmin=function(){return jQuery(".designer_app_wrapper").hasClass("admin")},$scope.isGuest=function(){return jQuery(".designer_app_wrapper").hasClass("guest")}}]),angular.module("jewelryDesigner").controller("MyDesignsCtrl",["$scope","$stateParams","$rootScope","$document","Design",function($scope,$stateParams,$rootScope,$document,Design){angular.element(".main-container").removeClass("hero-splash"),$document.ready(function(){angular.element(".loader").hasClass("hidden")||angular.element(".loader").addClass("hidden")}),$scope.title="My Bracelets",$scope.inAdminArea=!1,$scope.designs=Design.query(),$scope.designs.$promise.then(function(){}),$scope.deleteDesign=function(designId){if(confirm("Are you sure you want to delete the design? This cannot be undone.")===!0){var ajaxUrl="/jewelrydesigner/api/deleteDesign",formKey=null;$document.ready(function(){$scope.inAdminArea=jQuery(".designer_app_wrapper").hasClass("admin"),$scope.inAdminArea&&(ajaxUrl="/jewelrydesigner/adminhtml_api/deleteDesign",formKey=jQuery(".designer_app_wrapper").data("form-key"))}),jQuery.ajax({url:ajaxUrl,type:"POST",dataType:"json",data:{id:designId,form_key:formKey}}).done(function(data){data.error||jQuery("li#design_"+data.design_id).fadeOut(700).remove(),PAN.DesignerWorkspace.showMessage(data.message)})}},$scope.showDesigns=function(){var showDesigns=$scope.designs.length>0?!0:!1;return showDesigns},$scope.isAdmin=function(){return jQuery(".designer_app_wrapper").hasClass("admin")}}]),angular.module("jewelryDesigner").controller("NavbarCtrl",["$scope","$stateParams",function(){}]),angular.module("jewelryDesigner").controller("ReviewCtrl",["$scope","$rootScope","$stateParams","$document","wsBracelet",function($scope,$rootScope,$stateParams,$document,wsBracelet){$scope.designStep="review",angular.element(".sidebar-toggle").addClass($scope.designStep).removeClass("charms").removeClass("bracelets").removeClass("clips").removeClass("active"),$document.ready(function(){angular.element(".loader").hasClass("hidden")||angular.element(".loader").addClass("hidden")}),$scope.getCurrentBracelet=function(){var bracelet=PAN.DesignerWorkspace.getCurrentBracelet();return bracelet},$scope.getBraceletLineItems=function(){var products,bracelet=$scope.current_bracelet;return null!==bracelet&&void 0!==bracelet?(products=JSON.parse(JSON.stringify(bracelet.products)),delete products.total_price):products=null,products},$scope.getBraceletSubtotal=function(){var bracelet=$scope.current_bracelet,total_price=0;return null!==bracelet&&void 0!==bracelet&&(total_price=bracelet.products.total_price),total_price},$scope.current_bracelet=wsBracelet,$scope.line_items=$scope.getBraceletLineItems(),$scope.showReview=null!==$scope.line_items?!0:!1,$scope.total_price=$scope.getBraceletSubtotal(),$rootScope.$on("design_loaded",function(){$scope.current_bracelet=$scope.getCurrentBracelet(),$scope.line_items=$scope.getBraceletLineItems(),$scope.showReview=null!==$scope.line_items?!0:!1,$scope.total_price=$scope.getBraceletSubtotal()}),$scope.addToWishlist=function(){var productsAsJson=JSON.stringify($scope.line_items);jQuery.ajax({url:"/jewelrydesigner/api/addToWishlist",type:"POST",dataType:"json",data:{products:productsAsJson}}).done(function(data){PAN.DesignerWorkspace.showMessage(data.message)})},$scope.addToCart=function(){var productsAsJson=JSON.stringify($scope.line_items);jQuery.ajax({url:"/jewelrydesigner/api/addToCart",type:"POST",dataType:"json",data:{products:productsAsJson}}).done(function(data){data.error===!1&&jQuery(".top-dropdowns .ajax-cart-update-wrapper").html(data.cartTop),PAN.DesignerWorkspace.showMessage(data.message)})},$scope.isAdmin=function(){return jQuery(".designer_app_wrapper").hasClass("admin")}}]),angular.module("jewelryDesigner").controller("ShareNavCtrl",["$scope","$stateParams","$rootScope",function($scope,$stateParams,$rootScope){$scope.title="Share This Bracelet",$rootScope.$on("shared_design_loaded",function(event,data){$scope.title=data.name})}]),angular.module("jewelryDesigner").controller("ShareSidebarCtrl",["$scope","$stateParams","design",function($scope,$stateParams,design){$scope.designStep="share",$scope.line_items=null!==design&&void 0!==design?JSON.parse(design.configuration):[],$scope.total_price=0,angular.forEach($scope.line_items,function(item){$scope.total_price=$scope.total_price+item.base_price*(item.qty+item.quantity_owned)})}]),angular.module("jewelryDesigner").controller("ShareWorkspaceCtrl",["$scope","$stateParams","$rootScope","design",function($scope,$stateParams,$rootScope,design){$scope.design=design,$rootScope.$emit("shared_design_loaded",design)}]),angular.module("jewelryDesigner").controller("TopnavCtrl",["$scope","$stateParams",function(){}]),angular.module("jewelryDesigner").controller("UiCtrl",["$scope","$stateParams",function(){}]),angular.module("jewelryDesigner").controller("WorkspaceCtrl",["$scope","$state","$stateParams","$rootScope","$document",function($scope,$state,$stateParams,$rootScope,$document){$scope.title="My New Bracelet",$scope.designId=$stateParams.designId,$scope.hideInstructions=!1,$scope.closeInstructions=function(){$scope.hideInstructions=!$scope.hideInstructions,$scope.hideInstructions&&angular.element(".designer_app_wrapper").addClass("hide-instructions")},$scope.shouldHideInstructions=function(){return jQuery(".designer_app_wrapper").hasClass("hide-instructions")},$rootScope.$on("design_loaded",function(event,data){void 0!==data.name&&($scope.title=data.name)}),$scope.editNameBtnLabel="Edit Name",$scope.showForm=!1,$scope.toggleEditNameField=function(){$scope.showForm=!$scope.showForm,$scope.editNameBtnLabel=$scope.showForm?"Save Name":"Edit Name",$scope.showForm||$scope.saveDesign()},$scope.isAvailable=!0,$scope.isInspiration=!1,$document.ready(function(){var width=jQuery(".design-canvas").width(),height=jQuery(".design-canvas").height(),center={x:Math.ceil(width/2),y:Math.ceil(height/2),rotate:!0};$scope.braceletCenter=center}),$scope.formData={attribute_options:{},is_already_owned:!1},"new"!==$scope.designId&&PAN.DesignerWorkspace.setCurrentDesignId($scope.designId),$scope.steps=[{name:"bracelets",htmlstr:'<span class="choose">Choose</span> Bracelet',designId:$stateParams.designId},{name:"charms",htmlstr:'<span class="choose">Choose</span> Charms',designId:$stateParams.designId},{name:"clips",htmlstr:'<span class="choose">Choose</span> Clips',designId:$stateParams.designId},{name:"review",htmlstr:"Review Bracelet",designId:$stateParams.designId}],$scope.modalShown=!1,$scope.toggleModal=function(){$scope.modalShown=!$scope.modalShown},$scope.handleBraceletSelect=function(bracelet,formData){PAN.DesignerWorkspace.setBracelet(bracelet,formData),$scope.toggleModal()},$scope.addToWorkspace=function(product,position,formData){(void 0===position||position==={})&&(position={x:287,y:265,rotate:!1,lock:!0}),PAN.DesignerWorkspace.addBead(product,position,null,formData),PAN.DesignerWorkspace.showMessage("Charm added to workspace!")},$scope.saveDesign=function(){var inspirationCheckBox=jQuery("#inspiration_chkbox"),inspirationCheckBoxValue=inspirationCheckBox.length>0?inspirationCheckBox.is(":checked"):!1,availableCheckBox=jQuery("#is_available_chkbox"),availableCheckBoxValue=availableCheckBox.length>0?availableCheckBox.is(":checked"):!0;PAN.DesignerWorkspace.saveDesign(availableCheckBoxValue,inspirationCheckBoxValue),$scope.isLoggedIn()&&PAN.DesignerWorkspace.showMessage("Bracelet has been updated!")},$scope.resetDesign=function(){PAN.DesignerWorkspace.startOver(),$state.go("ui.bracelets"),PAN.DesignerWorkspace.showMessage("Bracelet design reset!")},$scope.isAdmin=function(){return jQuery(".designer_app_wrapper").hasClass("admin")},$scope.isGuest=function(){return jQuery(".designer_app_wrapper").hasClass("guest")},$scope.isLoggedIn=function(){return jQuery(".designer_app_wrapper").hasClass("logged-in")}}]),angular.module("jewelryDesigner").factory("CatalogProduct",["$http",function($http){var CatalogProduct=function(productType,limit){this.items=[],this.dataItems=[],this.colors=[],this.themes=[],this.materials=[],this.sizes=[],this.busy=!1,this.productType=productType||"bracelets",this.limit=limit||20,this.offset=0;var isAdmin=angular.element(".designer_app_wrapper").hasClass("admin");this.inAdminArea=isAdmin,this.formKey=isAdmin?angular.element(".designer_app_wrapper").data("form-key"):null,this.secretKey=isAdmin?angular.element(".designer_app_wrapper").data("secret-key"):null,this.httpMethod="GET"};return CatalogProduct.prototype.getAll=function(){var that=this,url="/jewelrydesigner/api/products/type/"+this.productType;$http.get(url).success(function(data){for(var i=0;i<data.length;i++){var item=data[i];item.color instanceof Array?angular.forEach(item.color,function(c){null!==item.color&&-1==that.colors.indexOf(c)&&that.colors.push(c)}):null!==item.color&&-1==that.colors.indexOf(item.color)&&that.colors.push(item.color),item.theme instanceof Array?angular.forEach(item.theme,function(t){null!==item.theme&&-1==that.themes.indexOf(t)&&that.themes.push(t)}):null!==item.theme&&-1==that.themes.indexOf(item.theme)&&that.themes.push(item.theme),item.material instanceof Array?angular.forEach(item.material,function(m){null!==item.material&&-1==that.materials.indexOf(m)&&that.materials.push(m)}):null!==item.material&&-1==that.materials.indexOf(item.material)&&that.materials.push(item.material),this.dataItems.push(item)}}.bind(this))},CatalogProduct.prototype.nextPage=function(){if(!this.busy){this.busy=!0;var url="/jewelrydesigner/api/products/type/"+this.productType+"/limit/"+this.limit+"/offset/"+this.offset;$http.get(url).success(function(data){for(var i=0;i<data.length;i++)this.items.push(data[i]);this.offset=this.items.length,this.busy=!1}.bind(this))}},CatalogProduct}]),angular.module("jewelryDesigner").factory("Design",["$resource","$document",function($resource,$document){var inAdminArea=!1,resourceUrl="/jewelrydesigner/api/designs/",formKey=null,httpMethod="GET";return $document.ready(function(){inAdminArea=jQuery(".designer_app_wrapper").hasClass("admin"),inAdminArea&&(httpMethod="POST",formKey=jQuery(".designer_app_wrapper").data("form-key"),resourceUrl="/jewelrydesigner/adminhtml_api/designs/")}),$resource(resourceUrl,{},{query:{method:httpMethod,cache:!0,params:{form_key:formKey,inspirations:"@inspirations"},isArray:!0},get:{method:httpMethod,cache:!0,params:{id:"@id",form_key:formKey},isArray:!1}})}]),angular.module("jewelryDesigner").factory("Product",["$resource",function($resource){return $resource("/jewelrydesigner/api/products",{},{query:{method:"GET",cache:!0,params:{type:"@type"},isArray:!0}})}]),angular.module("jewelryDesigner").filter("orderObjectBy",function(){return function(items,field,reverse){var filtered=[];return angular.forEach(items,function(item){filtered.push(item)}),filtered.sort(function(a,b){return a[field]>b[field]?1:-1}),reverse&&filtered.reverse(),filtered}}),angular.module("jewelryDesigner").filter("replace",function(){return function(input,replaceMe,replaceWith){input=input||"",replaceMe=replaceMe||"PANDORA",replaceWith=replaceWith||"";var out=input.replace(replaceMe,replaceWith);return out}}),angular.module("jewelryDesigner").directive("bxSlider",[function(){return{restrict:"A",link:function(scope,element,attrs){scope.$on("repeatFinished",function(){element.bxSlider(scope.$eval("{"+attrs.bxSlider+"}"))})}}}]),angular.module("jewelryDesigner").directive("notifyWhenRepeatFinished",["$timeout",function($timeout){return{restrict:"A",link:function(scope){scope.$last===!0&&$timeout(function(){scope.$emit("repeatFinished")})}}}]);